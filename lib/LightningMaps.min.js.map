{"version":3,"sources":["webpack://LightningMaps/webpack/universalModuleDefinition","webpack://LightningMaps/webpack/bootstrap","webpack://LightningMaps/./node_modules/two-product/two-product.js","webpack://LightningMaps/./node_modules/robust-point-in-polygon/robust-pnp.js","webpack://LightningMaps/./node_modules/robust-orientation/orientation.js","webpack://LightningMaps/./node_modules/robust-sum/robust-sum.js","webpack://LightningMaps/./node_modules/robust-scale/robust-scale.js","webpack://LightningMaps/./node_modules/two-sum/two-sum.js","webpack://LightningMaps/./node_modules/robust-subtract/robust-diff.js","webpack://LightningMaps/./src/TileConversion.js","webpack://LightningMaps/./src/Tile.js","webpack://LightningMaps/./src/TileLayer.js","webpack://LightningMaps/./src/MapState.js","webpack://LightningMaps/./src/MarkerRenderer.js","webpack://LightningMaps/./src/defaultOptions.js","webpack://LightningMaps/./src/Map.js","webpack://LightningMaps/./src/Marker.js","webpack://LightningMaps/./node_modules/topojson-client/src/identity.js","webpack://LightningMaps/./node_modules/topojson-client/src/transform.js","webpack://LightningMaps/./node_modules/topojson-client/src/reverse.js","webpack://LightningMaps/./node_modules/topojson-client/src/feature.js","webpack://LightningMaps/./node_modules/topojson-client/src/bisect.js","webpack://LightningMaps/./src/Polygon.js","webpack://LightningMaps/./src/index.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","a","b","result","x","SPLITTER","ahi","alo","bhi","blo","y","Math","pow","vs","point","length","inside","lim","j","yi","yj","orient","yk","x0","min","x1","max","k","px","y0","y1","twoProduct","robustSum","robustScale","robustSubtract","NUM_EXPAND","cofactor","Array","generateSum","expr","join","slice","determinant","push","orientation","pos","neg","matrix","args","apply","posExpr","negExpr","funcName","code","Function","proc","orientation3Exact","orientation4Exact","CACHED","det","tol","adx","bdx","cdx","ady","bdy","cdy","adz","bdz","cdz","bdxcdy","cdxbdy","cdxady","adxcdy","adxbdy","bdxady","abs","slowOrient","undefined","procArgs","concat","generateOrientationProc","e","f","ne","nf","bv","scalarScalar","g","count","eptr","fptr","ei","ea","fi","fa","_x","_bv","q0","q1","twoSum","scale","ts","q","pq","br","ar","TileConversion","lon","zoom","rounded","arguments","tile","floor","lat","log","tan","PI","cos","z","atan","exp","tile2lat","tile2lon","sw","pixel","center","tileSize","pointDiff","tileX","lon2tile","tileY","lat2tile","coord","tileCenterX","tileCenterY","Tile","Tile_classCallCheck","this","_y","_zoom","TileLayer","map","tilesZoomLevel","TileLayer_classCallCheck","context","state","grid","gridHash","relativeTileOffset","loadedPercentage","canvasSize","tilesCount","ceil","options","tileAreaMultiplier","_this$map","centerY","round","centerX","horizontalTiles","getTilesCount","canvasDimensions","verticalTiles","centerYRounded","centerXRounded","startX","startY","isValid","ensureTileAsset","_this","id","tiles","tileUrl","source","Image","crossOrigin","tileId","src","loaded","onload","lastRequested","Date","getTime","canvasWidth","canvasHeight","centerOffset","fillStyle","fillRect","horizontalOverflow","verticalOverflow","moveOffset","drawImage","drawGenericBackground","err","debug","strokeStyle","strokeRect","beginPath","arc","fill","size","increment","lineX","lineY","moveTo","lineTo","stroke","totalTiles","loadedTiles","cachedTile","MapState","targetZoom","canvasCenter","MapState_classCallCheck","_center","_targetZoom","_tileSize","_canvasDimensions","_canvasCenter","_moveOffset","MarkerRenderer","renderMode","MarkerRenderer_classCallCheck","_markers","offscreenCanvas","renderedMapCenter","renderedZoomLevel","mapState","originZoom","mapBounds","forceRerender","determineOriginZoom","zoomDiff","shouldReRender","renderOffScreenCanvas","canvasDrawPosition","canvasDrawDimensions","mapCenterChanged","mapZoomChanged","createOffscreenCanvas","getVisibleMarkers","forEach","marker","position","latLonToPixel","coords","render","document","createElement","width","height","getContext","bounds","markers","filter","nw","se","markerSize","markerOffset","offset","defaultMapOptions","attribution","hideControlsUntilActive","markerRenderMode","panAccelerationMultiplier","maxPanAcceleration","throwTimingThresholdMs","throwVelocityThreshold","animationDurationMs","debounceIntervalMs","defaultMarkerOptions","color","type","image","enableShadow","enableStroke","lineWidth","defaultPolygonOptions","lineDash","enableFill","interactive","defaultPolygonHoverOptions","Map","canvas","Map_classCallCheck","Error","assign","initializeState","attachEvents","lastDrawState","onMarkerClicked","onMarkerHover","onPolygonClicked","onPolygonHover","onMapCenterChanged","onMapZoomChanged","onMapPanned","draw","requestAnimationFrame","targetMoveOffset","targetMoveOffsetIsCoord","moveAnimationStart","dragStartPosition","lastZoomEventActionTime","startZoom","zoomAnimationStart","lastMouseMoveEvent","mouseVelocities","markerRenderer","polygons","tileLayers","mousePosition","forceRedraw","forceRerenderMarkers","zoomValueIsValid","isReadyForZoomEvent","performance","now","isArray","parseFloat","animated","pixelToLatLon","position1","position2","time1","time2","addEventListener","event","preventDefault","deltaY","setZoom","updateMousePosition","handleMouseEventInteraction","getCanvasCenter","setTargetMoveOffset","timingThreshold","thresholdsToConsider","threshold","averageVelocity","reduce","accumulator","velocity","multiplier","updateCenter","vx","calculateVelocity","vy","sqrt","showControls","rect","getBoundingClientRect","clientX","left","clientY","top","time","timestamp","progress","percentage","easeOutQuad","latLon","differenceFromTarget","newZoomDiff","remainingTime","roundedZoom","diff","shift","_this2","allTiles","values","maxTilesToKeep","tileExpirationCutOff","tilesToConsider","sort","tilesToDeleteCount","splice","drawState","JSON","stringify","console","snapshotMapState","updateMoveOffset","updateZoom","tileLayer","calculateGrid","garbageCollect","shouldRedraw","drawTiles","renderPolygons","renderMarkers","renderControls","renderAttribution","getMapBounds","_this3","polygon","enablePolygonInteractivity","isCurrentlyDraggingMap","handleMouseOver","_this4","controlObjects","getControlObjects","item","isMouseOverObject","firstMarker","getMarkersBounds","controlObject","label","controlsOrMarkersIsHover","polygonIsHover","activatedAreas","eventHandler","meta","style","cursor","margin","_this5","renderControl","roundedRectangle","font","textAlign","textBaseline","fillText","textBounds","measureText","radius","quadraticCurveTo","closePath","_this6","addMarker","Marker","Marker_classCallCheck","_coords","_options","_meta","mapZoom","renderFunction","renderMarker","renderCircle","renderDonut","renderImage","save","restore","renderShadow","transform","bezierCurveTo","shadowColor","shadowBlur","ellipse","strokeMargin","identity","src_transform","kx","ky","dx","translate","dy","input","output","reverse","array","feature","topology","features","geometries","feature_feature","bbox","properties","geometry","feature_object","transformPoint","arcs","points","pop","line","ring","coordinates","Polygon","json","objectName","hoverOptions","Polygon_classCallCheck","_hoverOptions","globalIndex","prepareGlobalDataObject","keys","objects","lightningMapsPolygons","index","projectedGeometry","currentlyZooming","calculateCenterOffset","isHover","list","classifyPoint","applyContextStyles","_objectSpread","projectGeometry","calculatePolygonExtends","imagePosition","polygonExtends","minX","minY","imageRect","right","bottom","renderOffscreenCanvas","imageDrawPosition","scaledWidth","polygonDimensions","scaledHeight","clipRect","maxX","maxY","mapGeometry","offscreenContext","setLineDash","lineJoin","pointCallback","projectPoint","__webpack_exports__","Map_Map","Marker_Marker","Polygon_Polygon"],"mappings":"CAAA,SAAAA,EAAAC,GACA,iBAAAC,SAAA,iBAAAC,OACAA,OAAAD,QAAAD,IACA,mBAAAG,eAAAC,IACAD,OAAA,mBAAAH,GACA,iBAAAC,QACAA,QAAA,cAAAD,IAEAD,EAAA,cAAAC,IARA,CASCK,OAAA,WACD,mBCTA,IAAAC,EAAA,GAGA,SAAAC,EAAAC,GAGA,GAAAF,EAAAE,GACA,OAAAF,EAAAE,GAAAP,QAGA,IAAAC,EAAAI,EAAAE,GAAA,CACAC,EAAAD,EACAE,GAAA,EACAT,QAAA,IAUA,OANAU,EAAAH,GAAAI,KAAAV,EAAAD,QAAAC,IAAAD,QAAAM,GAGAL,EAAAQ,GAAA,EAGAR,EAAAD,QA0DA,OArDAM,EAAAM,EAAAF,EAGAJ,EAAAO,EAAAR,EAGAC,EAAAQ,EAAA,SAAAd,EAAAe,EAAAC,GACAV,EAAAW,EAAAjB,EAAAe,IACAG,OAAAC,eAAAnB,EAAAe,EAAA,CAA0CK,YAAA,EAAAC,IAAAL,KAK1CV,EAAAgB,EAAA,SAAAtB,GACA,oBAAAuB,eAAAC,aACAN,OAAAC,eAAAnB,EAAAuB,OAAAC,YAAA,CAAwDC,MAAA,WAExDP,OAAAC,eAAAnB,EAAA,cAAiDyB,OAAA,KAQjDnB,EAAAoB,EAAA,SAAAD,EAAAE,GAEA,GADA,EAAAA,IAAAF,EAAAnB,EAAAmB,IACA,EAAAE,EAAA,OAAAF,EACA,KAAAE,GAAA,iBAAAF,QAAAG,WAAA,OAAAH,EACA,IAAAI,EAAAX,OAAAY,OAAA,MAGA,GAFAxB,EAAAgB,EAAAO,GACAX,OAAAC,eAAAU,EAAA,WAAyCT,YAAA,EAAAK,UACzC,EAAAE,GAAA,iBAAAF,EAAA,QAAAM,KAAAN,EAAAnB,EAAAQ,EAAAe,EAAAE,EAAA,SAAAA,GAAgH,OAAAN,EAAAM,IAAqBC,KAAA,KAAAD,IACrI,OAAAF,GAIAvB,EAAA2B,EAAA,SAAAhC,GACA,IAAAe,EAAAf,KAAA2B,WACA,WAA2B,OAAA3B,EAAA,SAC3B,WAAiC,OAAAA,GAEjC,OADAK,EAAAQ,EAAAE,EAAA,IAAAA,GACAA,GAIAV,EAAAW,EAAA,SAAAiB,EAAAC,GAAsD,OAAAjB,OAAAkB,UAAAC,eAAA1B,KAAAuB,EAAAC,IAGtD7B,EAAAgC,EAAA,GAIAhC,IAAAiC,EAAA,kCChFAtC,EAAAD,QAIA,SAAAwC,EAAAC,EAAAC,GACA,IAAAC,EAAAH,EAAAC,EAEA5B,EAAA+B,EAAAJ,EAEAK,EAAAhC,GADAA,EAAA2B,GAEAM,EAAAN,EAAAK,EAEA/B,EAAA8B,EAAAH,EAEAM,EAAAjC,GADAA,EAAA2B,GAEAO,EAAAP,EAAAM,EAMAE,EAAAH,EAAAE,GAJAL,EAAAE,EAAAE,EACAD,EAAAC,EACAF,EAAAG,GAIA,GAAAN,EAGA,OAFAA,EAAA,GAAAO,EACAP,EAAA,GAAAC,EACAD,EAGA,OAAAO,EAAAN,IA3BA,IAAAC,IAAAM,KAAAC,IAAA,0BCJAlD,EAAAD,QAIA,SAAAoD,EAAAC,GAMA,IALA,IAAAV,EAAAU,EAAA,GACAJ,EAAAI,EAAA,GACApB,EAAAmB,EAAAE,OACAC,EAAA,EACAC,EAAAvB,EACAzB,EAAA,EAAAiD,EAAAxB,EAAA,EAAyBzB,EAAAgD,EAAOC,EAAAjD,IAAA,CAChC,IAAAgC,EAAAY,EAAA5C,GACAiC,EAAAW,EAAAK,GACAC,EAAAlB,EAAA,GACAmB,EAAAlB,EAAA,GACA,GAAAkB,EAAAD,GACA,GAAAC,EAAAV,KAAAS,EAAA,CACA,IAAAnB,EAAAqB,EAAApB,EAAAC,EAAAY,GACA,OAAAd,EACA,SAEAgB,GAAA,EAAAhB,EAAA,OAEO,GAAAU,IAAAS,EAAA,CACP,IAAA7C,EAAAuC,GAAA5C,EAAA,GAAAyB,GACA4B,EAAAhD,EAAA,GACA,GAAA6C,EAAAG,EAAA,CACA,IAAAtB,EAAAqB,EAAApB,EAAAC,EAAAY,GACA,OAAAd,EACA,SAEAgB,GAAA,EAAAhB,EAAA,SAIK,GAAAmB,EAAAC,GACL,GAAAD,EAAAT,KAAAU,EAAA,CACA,IAAApB,EAAAqB,EAAApB,EAAAC,EAAAY,GACA,OAAAd,EACA,SAEAgB,GAAAhB,EAAA,SAEO,GAAAU,IAAAS,EAAA,CACP,IAAA7C,EAAAuC,GAAA5C,EAAA,GAAAyB,GACA4B,EAAAhD,EAAA,GACA,GAAAgD,EAAAH,EAAA,CACA,IAAAnB,EAAAqB,EAAApB,EAAAC,EAAAY,GACA,OAAAd,EACA,SAEAgB,GAAAhB,EAAA,WAIK,GAAAU,IAAAS,EAAA,CACL,IAAAI,EAAAZ,KAAAa,IAAAvB,EAAA,GAAAC,EAAA,IACAuB,EAAAd,KAAAe,IAAAzB,EAAA,GAAAC,EAAA,IACA,OAAAjC,EAAA,CACA,KAAAiD,EAAA,IACA,IAAAS,GAAAT,EAAAxB,EAAA,GAAAA,EACAK,EAAAc,EAAAc,GACA,GAAA5B,EAAA,KAAAW,EACA,MAEA,IAAAkB,EAAA7B,EAAA,GACAwB,EAAAZ,KAAAa,IAAAD,EAAAK,GACAH,EAAAd,KAAAe,IAAAD,EAAAG,GACAV,EAAAS,EAEA,OAAAT,EACA,OAAAK,GAAAnB,MAAAqB,EACA,EAEA,EAEAR,EAAAC,EAAA,EAGA,IADA,IAAAW,EAAAhB,GAAAK,EAAAxB,EAAA,GAAAA,GAAA,GACAzB,EAAA,EAAAgD,GAAA,CACA,IAAAlB,EAAAc,EAAA5C,EAAA,GACA,GAAA8B,EAAA,KAAAW,EACA,MAEA,IAAAkB,EAAA7B,EAAA,GACAwB,EAAAZ,KAAAa,IAAAD,EAAAK,GACAH,EAAAd,KAAAe,IAAAD,EAAAG,GACA3D,GAAA,EAEA,GAAAsD,GAAAnB,MAAAqB,EACA,SAEA,IAAAK,EAAAjB,GAAA5C,EAAA,GAAAyB,GAAA,GACAU,EAAAmB,GAAAM,EAAAnB,GAAAoB,EAAApB,IACAM,GAAA,IAIA,SAAAA,EAAA,GAhGA,IAAAK,EAAatD,EAAQ,iCCArB,IAAAgE,EAAiBhE,EAAQ,GACzBiE,EAAgBjE,EAAQ,GACxBkE,EAAkBlE,EAAQ,GAC1BmE,EAAqBnE,EAAQ,GAE7BoE,EAAA,EAMA,SAAAC,EAAA/D,EAAAC,GAEA,IADA,IAAA6B,EAAA,IAAAkC,MAAAhE,EAAA0C,OAAA,GACA9C,EAAA,EAAcA,EAAAI,EAAA0C,SAAY9C,EAE1B,IADA,IAAAc,EAAAoB,EAAAlC,EAAA,OAAAoE,MAAAhE,EAAA0C,OAAA,GACAG,EAAA,EAAAS,EAAA,EAAoBT,EAAA7C,EAAA0C,SAAYG,EAChCA,IAAA5C,IAGAS,EAAA4C,KAAAtD,EAAAJ,GAAAiD,IAGA,OAAAf,EAqBA,SAAAmC,EAAAC,GACA,OAAAA,EAAAxB,OACA,OAAAwB,EAAA,GACG,OAAAA,EAAAxB,OACH,cAAAwB,EAAA,OAAAA,EAAA,QAAAC,KAAA,IAEA,IAAAnE,EAAAkE,EAAAxB,QAAA,EACA,cAAAuB,EAAAC,EAAAE,MAAA,EAAApE,IAAA,IAAAiE,EAAAC,EAAAE,MAAApE,IAAA,KAAAmE,KAAA,IAIA,SAAAE,EAAArE,GACA,OAAAA,EAAA0C,OACA,oBAAA1C,EAAA,UAAAA,EAAA,iBAAAA,EAAA,UAAAA,EAAA,YAAAmE,KAAA,KAGA,IADA,IAAAD,EAAA,GACAtE,EAAA,EAAgBA,EAAAI,EAAA0C,SAAY9C,EAC5BsE,EAAAI,KAAA,UAAAL,EAAAI,EAAAN,EAAA/D,EAAAJ,KAAA,KAxBAyB,EAwBAzB,EAvBA,EAAAyB,EACA,IAEA,IAoBArB,EAAA,GAAAJ,GAAA,KAAAuE,KAAA,KAEA,OAAAD,EA1BA,IAAA7C,EA8BA,SAAAkD,EAAAlD,GAKA,IAJA,IAAAmD,EAAA,GACAC,EAAA,GACAzE,EA5CA,SAAAqB,GAEA,IADA,IAAAS,EAAA,IAAAkC,MAAA3C,GACAzB,EAAA,EAAcA,EAAAyB,IAAKzB,EAAA,CACnBkC,EAAAlC,GAAA,IAAAoE,MAAA3C,GACA,QAAAwB,EAAA,EAAgBA,EAAAxB,IAAKwB,EACrBf,EAAAlC,GAAAiD,GAAA,KAAAA,EAAA,IAAAxB,EAAAzB,EAAA,OAAAuE,KAAA,IAGA,OAAArC,EAoCA4C,CAAArD,GACAsD,EAAA,GACA/E,EAAA,EAAcA,EAAAyB,IAAKzB,EACnB,MAAAA,GACA4E,EAAAF,KAAAM,MAAAJ,EAAAH,EAAAN,EAAA/D,EAAAJ,KAEA6E,EAAAH,KAAAM,MAAAH,EAAAJ,EAAAN,EAAA/D,EAAAJ,KAEA+E,EAAAL,KAAA,IAAA1E,GAEA,IAAAiF,EAAAZ,EAAAO,GACAM,EAAAb,EAAAQ,GACAM,EAAA,cAAA1D,EAAA,QACA2D,EAAA,aAAAD,EAAA,IAAAJ,EAAAR,OAAA,WAA0DU,EAAA,MAAAC,EAAA,6CACnCC,GAAAZ,KAAA,IAEvB,OADA,IAAAc,SAAA,2BAAAD,EACAE,CAAAvB,EAAAD,EAAAE,EAAAC,GAGA,IAAAsB,EAAAZ,EAAA,GACAa,EAAAb,EAAA,GAEAc,EAAA,CACA,WAA2B,UAC3B,WAA2B,UAC3B,SAAAzD,EAAAC,GACA,OAAAA,EAAA,GAAAD,EAAA,IAEA,SAAAA,EAAAC,EAAA5B,GACA,IAGA0B,EAHA9B,GAAA+B,EAAA,GAAA3B,EAAA,KAAA4B,EAAA,GAAA5B,EAAA,IACAS,GAAAkB,EAAA,GAAA3B,EAAA,KAAA4B,EAAA,GAAA5B,EAAA,IACAqF,EAAAzF,EAAAa,EAEA,GAAAb,EAAA,GACA,GAAAa,GAAA,EACA,OAAA4E,EAEA3D,EAAA9B,EAAAa,MAEK,MAAAb,EAAA,GAOL,OAAAyF,EANA,GAAA5E,GAAA,EACA,OAAA4E,EAEA3D,IAAA9B,EAAAa,GAKA,IAAA6E,EA7GA,uBA6GA5D,EACA,OAAA2D,GAAAC,GAAAD,IAAAC,EACAD,EAEAH,EAAAvD,EAAAC,EAAA5B,IAEA,SAAA2B,EAAAC,EAAA5B,EAAAC,GACA,IAAAsF,EAAA5D,EAAA,GAAA1B,EAAA,GACAuF,EAAA5D,EAAA,GAAA3B,EAAA,GACAwF,EAAAzF,EAAA,GAAAC,EAAA,GACAyF,EAAA/D,EAAA,GAAA1B,EAAA,GACA0F,EAAA/D,EAAA,GAAA3B,EAAA,GACA2F,EAAA5F,EAAA,GAAAC,EAAA,GACA4F,EAAAlE,EAAA,GAAA1B,EAAA,GACA6F,EAAAlE,EAAA,GAAA3B,EAAA,GACA8F,EAAA/F,EAAA,GAAAC,EAAA,GACA+F,EAAAR,EAAAI,EACAK,EAAAR,EAAAE,EACAO,EAAAT,EAAAC,EACAS,EAAAZ,EAAAK,EACAQ,EAAAb,EAAAI,EACAU,EAAAb,EAAAE,EACAL,EAAAQ,GAAAG,EAAAC,GACAH,GAAAI,EAAAC,GACAJ,GAAAK,EAAAC,GAIAf,EAxIA,wBAqIAjD,KAAAiE,IAAAN,GAAA3D,KAAAiE,IAAAL,IAAA5D,KAAAiE,IAAAT,IACAxD,KAAAiE,IAAAJ,GAAA7D,KAAAiE,IAAAH,IAAA9D,KAAAiE,IAAAR,IACAzD,KAAAiE,IAAAF,GAAA/D,KAAAiE,IAAAD,IAAAhE,KAAAiE,IAAAP,IAEA,OAAAV,EAAAC,IAAAD,EAAAC,EACAD,EAEAF,EAAAxD,EAAAC,EAAA5B,EAAAC,KAIA,SAAAsG,EAAA7B,GACA,IAAAO,EAAAG,EAAAV,EAAAjC,QAIA,OAHAwC,IACAA,EAAAG,EAAAV,EAAAjC,QAAA6B,EAAAI,EAAAjC,SAEAwC,EAAAN,WAAA6B,EAAA9B,IAGA,WACA,KAAAU,EAAA3C,QAAAoB,GACAuB,EAAAf,KAAAC,EAAAc,EAAA3C,SAIA,IAFA,IAAAiC,EAAA,GACA+B,EAAA,SACA9G,EAAA,EAAcA,GAAAkE,IAAelE,EAC7B+E,EAAAL,KAAA,IAAA1E,GACA8G,EAAApC,KAAA,IAAA1E,GAEA,IAAAoF,EAAA,CACA,2BAAAL,EAAAR,OAAA,sDAEA,IAAAvE,EAAA,EAAcA,GAAAkE,IAAelE,EAC7BoF,EAAAV,KAAA,QAAA1E,EAAA,YAAAA,EAAA,IAAA+E,EAAAP,MAAA,EAAAxE,GAAAuE,OAAA,MAEAa,EAAAV,KAAA,mIACAoC,EAAApC,KAAAU,EAAAb,KAAA,KAEA,IAAAe,EAAAD,SAAAL,WAAA6B,EAAAC,GAEA,IADArH,EAAAD,QAAA8F,EAAAN,WAAA6B,EAAA,CAAAD,GAAAG,OAAAtB,IACAzF,EAAA,EAAcA,GAAAkE,IAAelE,EAC7BP,EAAAD,QAAAQ,GAAAyF,EAAAzF,GAIAgH,iCC3LAvH,EAAAD,QAgBA,SAAAyH,EAAAC,GACA,IAAAC,EAAA,EAAAF,EAAAnE,OACAsE,EAAA,EAAAF,EAAApE,OACA,OAAAqE,GAAA,IAAAC,EACA,OAjBA,SAAApF,EAAAC,GACA,IAAAE,EAAAH,EAAAC,EACAoF,EAAAlF,EAAAH,EAIAS,EADAT,GAFAG,EAAAkF,IACApF,EAAAoF,GAGA,GAAA5E,EACA,OAAAA,EAAAN,GAEA,OAAAA,GAOAmF,CAAAL,EAAA,GAAAC,EAAA,IAEA,IAUAlF,EAAAC,EATAsF,EAAA,IAAAnD,MADA+C,EAAAC,GAEAI,EAAA,EACAC,EAAA,EACAC,EAAA,EACAf,EAAAjE,KAAAiE,IACAgB,EAAAV,EAAAQ,GACAG,EAAAjB,EAAAgB,GACAE,EAAAX,EAAAQ,GACAI,EAAAnB,EAAAkB,GAEAD,EAAAE,GACA7F,EAAA0F,GACAF,GAAA,GACAN,IACAQ,EAAAV,EAAAQ,GACAG,EAAAjB,EAAAgB,MAGA1F,EAAA4F,GACAH,GAAA,GACAN,IACAS,EAAAX,EAAAQ,GACAI,EAAAnB,EAAAkB,KAGAJ,EAAAN,GAAAS,EAAAE,GAAAJ,GAAAN,GACApF,EAAA2F,GACAF,GAAA,GACAN,IACAQ,EAAAV,EAAAQ,GACAG,EAAAjB,EAAAgB,MAGA3F,EAAA6F,GACAH,GAAA,GACAN,IACAS,EAAAX,EAAAQ,GACAI,EAAAnB,EAAAkB,KAGA,IAKAE,EAAAC,EALA7F,EAAAH,EAAAC,EACAoF,EAAAlF,EAAAH,EACAS,EAAAR,EAAAoF,EACAY,EAAAxF,EACAyF,EAAA/F,EAEA,KAAAsF,EAAAN,GAAAO,EAAAN,GACAQ,EAAAE,GACA9F,EAAA2F,GACAF,GAAA,GACAN,IACAQ,EAAAV,EAAAQ,GACAG,EAAAjB,EAAAgB,MAGA3F,EAAA6F,GACAH,GAAA,GACAN,IACAS,EAAAX,EAAAQ,GACAI,EAAAnB,EAAAkB,MAMApF,GAHAR,EAAAgG,IAEAZ,GADAlF,EAAAH,EAAAC,GACAD,MAGAuF,EAAAC,KAAA/E,GAOAwF,EADAC,IAJAH,EAAAG,EAAA/F,IACA6F,EAAAD,EAAAG,KAEA/F,EAAA6F,GAGAE,EAAAH,EAEA,KAAAN,EAAAN,IAKA1E,GAHAR,EAAAgG,IAEAZ,GADAlF,GAFAH,EAAA2F,GAEA1F,GACAD,MAGAuF,EAAAC,KAAA/E,GAOAwF,EADAC,IAJAH,EAAAG,EAAA/F,IACA6F,EAAAD,EAAAG,KAEA/F,EAAA6F,GAGAE,EAAAH,GACAN,GAAA,GACAN,IACAQ,EAAAV,EAAAQ,IAGA,KAAAC,EAAAN,IAKA3E,GAHAR,EAAAgG,IAEAZ,GADAlF,GAFAH,EAAA6F,GAEA5F,GACAD,MAGAuF,EAAAC,KAAA/E,GAOAwF,EADAC,IAJAH,EAAAG,EAAA/F,IACA6F,EAAAD,EAAAG,KAEA/F,EAAA6F,GAGAE,EAAAH,GACAL,GAAA,GACAN,IACAS,EAAAX,EAAAQ,IAGAO,IACAV,EAAAC,KAAAS,GAEAC,IACAX,EAAAC,KAAAU,GAEAV,IACAD,EAAAC,KAAA,GAGA,OADAD,EAAAzE,OAAA0E,EACAD,iCCxJA,IAAAzD,EAAiBhE,EAAQ,GACzBqI,EAAarI,EAAQ,GAErBL,EAAAD,QAEA,SAAAyH,EAAAmB,GACA,IAAA3G,EAAAwF,EAAAnE,OACA,OAAArB,EAAA,CACA,IAAA4G,EAAAvE,EAAAmD,EAAA,GAAAmB,GACA,OAAAC,EAAA,GACAA,EAEA,CAAAA,EAAA,IAEA,IAAAd,EAAA,IAAAnD,MAAA,EAAA3C,GACA6G,EAAA,QACApH,EAAA,QACAsG,EAAA,EACA1D,EAAAmD,EAAA,GAAAmB,EAAAE,GACAA,EAAA,KACAf,EAAAC,KAAAc,EAAA,IAEA,QAAAtI,EAAA,EAAcA,EAAAyB,IAAKzB,EAAA,CACnB8D,EAAAmD,EAAAjH,GAAAoI,EAAAlH,GACA,IAAAqH,EAAAD,EAAA,GACAH,EAAAI,EAAArH,EAAA,GAAAoH,GACAA,EAAA,KACAf,EAAAC,KAAAc,EAAA,IAEA,IAAAtG,EAAAd,EAAA,GACAe,EAAAqG,EAAA,GACAnG,EAAAH,EAAAC,EACAoF,EAAAlF,EAAAH,EACAS,EAAAR,EAAAoF,EACAiB,EAAA,GAAAnG,EACAM,IACA8E,EAAAC,KAAA/E,GAGA6F,EAAA,KACAf,EAAAC,KAAAc,EAAA,IAEA,IAAAd,IACAD,EAAAC,KAAA,GAGA,OADAD,EAAAzE,OAAA0E,EACAD,iCC9CA9H,EAAAD,QAEA,SAAAwC,EAAAC,EAAAC,GACA,IAAAC,EAAAH,EAAAC,EACAoF,EAAAlF,EAAAH,EAEAwG,EAAAvG,EAAAoF,EACAoB,EAAAzG,GAFAG,EAAAkF,GAGA,GAAAnF,EAGA,OAFAA,EAAA,GAAAuG,EAAAD,EACAtG,EAAA,GAAAC,EACAD,EAEA,OAAAuG,EAAAD,EAAArG,kCCbA1C,EAAAD,QAgBA,SAAAyH,EAAAC,GACA,IAAAC,EAAA,EAAAF,EAAAnE,OACAsE,EAAA,EAAAF,EAAApE,OACA,OAAAqE,GAAA,IAAAC,EACA,OAjBA,SAAApF,EAAAC,GACA,IAAAE,EAAAH,EAAAC,EACAoF,EAAAlF,EAAAH,EAIAS,EADAT,GAFAG,EAAAkF,IACApF,EAAAoF,GAGA,GAAA5E,EACA,OAAAA,EAAAN,GAEA,OAAAA,GAOAmF,CAAAL,EAAA,IAAAC,EAAA,IAEA,IAUAlF,EAAAC,EATAsF,EAAA,IAAAnD,MADA+C,EAAAC,GAEAI,EAAA,EACAC,EAAA,EACAC,EAAA,EACAf,EAAAjE,KAAAiE,IACAgB,EAAAV,EAAAQ,GACAG,EAAAjB,EAAAgB,GACAE,GAAAX,EAAAQ,GACAI,EAAAnB,EAAAkB,GAEAD,EAAAE,GACA7F,EAAA0F,GACAF,GAAA,GACAN,IACAQ,EAAAV,EAAAQ,GACAG,EAAAjB,EAAAgB,MAGA1F,EAAA4F,GACAH,GAAA,GACAN,IACAS,GAAAX,EAAAQ,GACAI,EAAAnB,EAAAkB,KAGAJ,EAAAN,GAAAS,EAAAE,GAAAJ,GAAAN,GACApF,EAAA2F,GACAF,GAAA,GACAN,IACAQ,EAAAV,EAAAQ,GACAG,EAAAjB,EAAAgB,MAGA3F,EAAA6F,GACAH,GAAA,GACAN,IACAS,GAAAX,EAAAQ,GACAI,EAAAnB,EAAAkB,KAGA,IAKAE,EAAAC,EALA7F,EAAAH,EAAAC,EACAoF,EAAAlF,EAAAH,EACAS,EAAAR,EAAAoF,EACAY,EAAAxF,EACAyF,EAAA/F,EAEA,KAAAsF,EAAAN,GAAAO,EAAAN,GACAQ,EAAAE,GACA9F,EAAA2F,GACAF,GAAA,GACAN,IACAQ,EAAAV,EAAAQ,GACAG,EAAAjB,EAAAgB,MAGA3F,EAAA6F,GACAH,GAAA,GACAN,IACAS,GAAAX,EAAAQ,GACAI,EAAAnB,EAAAkB,MAMApF,GAHAR,EAAAgG,IAEAZ,GADAlF,EAAAH,EAAAC,GACAD,MAGAuF,EAAAC,KAAA/E,GAOAwF,EADAC,IAJAH,EAAAG,EAAA/F,IACA6F,EAAAD,EAAAG,KAEA/F,EAAA6F,GAGAE,EAAAH,EAEA,KAAAN,EAAAN,IAKA1E,GAHAR,EAAAgG,IAEAZ,GADAlF,GAFAH,EAAA2F,GAEA1F,GACAD,MAGAuF,EAAAC,KAAA/E,GAOAwF,EADAC,IAJAH,EAAAG,EAAA/F,IACA6F,EAAAD,EAAAG,KAEA/F,EAAA6F,GAGAE,EAAAH,GACAN,GAAA,GACAN,IACAQ,EAAAV,EAAAQ,IAGA,KAAAC,EAAAN,IAKA3E,GAHAR,EAAAgG,IAEAZ,GADAlF,GAFAH,EAAA6F,GAEA5F,GACAD,MAGAuF,EAAAC,KAAA/E,GAOAwF,EADAC,IAJAH,EAAAG,EAAA/F,IACA6F,EAAAD,EAAAG,KAEA/F,EAAA6F,GAGAE,EAAAH,GACAL,GAAA,GACAN,IACAS,GAAAX,EAAAQ,IAGAO,IACAV,EAAAC,KAAAS,GAEAC,IACAX,EAAAC,KAAAU,GAEAV,IACAD,EAAAC,KAAA,GAGA,OADAD,EAAAzE,OAAA0E,EACAD,kNCzJqBmB,uLACHC,EAAKC,GAAsB,IAAhBC,IAAgBC,UAAAhG,OAAA,QAAA+D,IAAAiC,UAAA,KAAAA,UAAA,GACnCC,GAAQJ,EAAM,KAAO,IAAMjG,KAAKC,IAAI,EAAGiG,GAE7C,OAAOC,EACHnG,KAAKsG,MAAMD,GACXA,mCAGUE,EAAKL,GAAsB,IAAhBC,IAAgBC,UAAAhG,OAAA,QAAA+D,IAAAiC,UAAA,KAAAA,UAAA,GACnCC,GAAQ,EAAIrG,KAAKwG,IAAIxG,KAAKyG,IAAIF,EAAMvG,KAAK0G,GAAK,KAAO,EAAI1G,KAAK2G,IAAIJ,EAAMvG,KAAK0G,GAAK,MACpF1G,KAAK0G,IAAM,EAAI1G,KAAKC,IAAI,EAAGiG,GAE/B,OAAOC,EACHnG,KAAKsG,MAAMD,GACXA,mCAGU5G,EAAGmH,GACjB,OAAOnH,EAAIO,KAAKC,IAAI,EAAG2G,GAAK,IAAM,qCAGpB7G,EAAG6G,GACjB,IAAM7H,EAAIiB,KAAK0G,GAAK,EAAI1G,KAAK0G,GAAK3G,EAAIC,KAAKC,IAAI,EAAG2G,GAElD,OAAO,IAAM5G,KAAK0G,GAAK1G,KAAK6G,KAAK,IAAO7G,KAAK8G,IAAI/H,GAAKiB,KAAK8G,KAAK/H,8CAG1CU,EAAGM,EAAGmG,GAC5B,MAAO,CACLzB,GAAI,CACFuB,EAAee,SAAShH,EAAGmG,GAC3BF,EAAegB,SAASvH,EAAI,EAAGyG,IAGjCe,GAAI,CACFjB,EAAee,SAAShH,EAAI,EAAGmG,GAC/BF,EAAegB,SAASvH,EAAGyG,2CAKZgB,EAAOC,EAAQjB,EAAMkB,GACxC,IAAMC,EAAY,CAChBH,EAAM,GAAKE,EACXF,EAAM,GAAKE,GAGPE,EAAQtB,EAAeuB,SAASJ,EAAO,GAAIjB,GAAM,GAASmB,EAAU,GACpEG,EAAQxB,EAAeyB,SAASN,EAAO,GAAIjB,GAAM,GAASmB,EAAU,GAE1E,MAAO,CACLrB,EAAee,SAASS,EAAOtB,GAC/BF,EAAegB,SAASM,EAAOpB,0CAIdwB,EAAOP,EAAQjB,EAAMkB,GACxC,IAAME,EAAQtB,EAAeuB,SAASG,EAAM,GAAIxB,GAAM,GAChDsB,EAAQxB,EAAeyB,SAASC,EAAM,GAAIxB,GAAM,GAElDyB,EAAc,EAAGC,EAAc,EAOnC,OALIT,IACFQ,EAAc3B,EAAeuB,SAASJ,EAAO,GAAIjB,GAAM,GACvD0B,EAAc5B,EAAeyB,SAASN,EAAO,GAAIjB,GAAM,IAGlD,GACHoB,EAAQK,GAAeP,IACvBI,EAAQI,GAAeR,0NCvEVS,aACnB,SAAAA,EAAYpI,EAAGM,EAAGmG,gGAAM4B,CAAAC,KAAAF,GACtBE,KAAK1C,GAAK5F,EACVsI,KAAKC,GAAKjI,EACVgI,KAAKE,MAAQ/B,2DAoBb,IAAMnF,EAAO,GAAKgH,KAAK7B,KAEvB,QAAI6B,KAAKtI,GAAKsB,GAAOgH,KAAKtI,EAAI,GAAKsI,KAAKhI,GAAKgB,GAAOgH,KAAKhI,EAAI,6BAlB7D,OAAOgI,KAAK1C,6BAIZ,OAAO0C,KAAKC,gCAIZ,OAAOD,KAAKE,iCAIZ,MAAO,CAACF,KAAKtI,EAAGsI,KAAKhI,EAAGgI,KAAK7B,MAAMrE,KAAK,oNCjBvBqG,aAEnB,SAAAA,EAAYC,GAA4B,IAAvBC,EAAuBhC,UAAAhG,OAAA,QAAA+D,IAAAiC,UAAA,GAAAA,UAAA,GAAN,kGAAMiC,CAAAN,KAAAG,GACtCH,KAAKI,IAAMA,EACXJ,KAAKK,eAAiBA,EAEtBL,KAAKO,QAAUH,EAAIG,QAEnBP,KAAKQ,MAAQ,CACXC,KAAM,GACNC,SAAU,KACVC,mBAAoB,CAAC,EAAG,4DAK1B,MAAO,CACLX,KAAKQ,MACLR,KAAKY,0DAIKC,GACZ,IAAIC,EAAa7I,KAAK8I,KAAKF,EAAab,KAAKI,IAAIY,QAAQ3B,UAAYW,KAAKI,IAAIY,QAAQC,mBAMtF,OAJIH,EAAa,GAAM,GACrBA,IAGKA,0CAGO,IAAAI,EACalB,KAAKI,IAAxBI,EADMU,EACNV,MAAOQ,EADDE,EACCF,QAETG,EAAUlD,EAAeyB,SAASsB,EAAQ5B,OAAO,GAAInH,KAAKmJ,MAAMpB,KAAKK,gBAAkBW,EAAQ7C,OAAO,GACtGkD,EAAUpD,EAAeuB,SAASwB,EAAQ5B,OAAO,GAAInH,KAAKmJ,MAAMpB,KAAKK,gBAAkBW,EAAQ7C,OAAO,GACtGuC,EAAW,CAACS,EAASE,GAASvH,KAAK,KAIzC,GAF6BkG,KAAKQ,MAAME,WAAaA,EAErD,CAIA,IAAMY,EAAkBtB,KAAKuB,cAAcf,EAAMgB,iBAAiB,IAC5DC,EAAgBzB,KAAKuB,cAAcf,EAAMgB,iBAAiB,IAG1DE,EAAiBzJ,KAAKsG,MAAM4C,GAC5BQ,EAAiB1J,KAAKsG,MAAM8C,GAElCrB,KAAKQ,MAAMG,mBAAqB,CAC9B1I,KAAKiE,IAAImF,EAAUM,GACnB1J,KAAKiE,IAAIiF,EAAUO,IAQrB,IALA,IAAME,EAASD,EAAiB1J,KAAKsG,MAAM+C,EAAkB,GACvDO,EAASH,EAAiBzJ,KAAKsG,MAAMkD,EAAgB,GAEvDhB,EAAO,GAEFzI,EAAI,EAAGA,EAAIyJ,EAAezJ,IACjC,IAAK,IAAIN,EAAI,EAAGA,EAAI4J,EAAiB5J,IAAK,CACnC+I,EAAK/I,KACR+I,EAAK/I,GAAK,IAGZ,IAGM4G,EAAO,IAAIwB,EAHH8B,EAASlK,EACTmK,EAAS7J,EAEaC,KAAKmJ,MAAMpB,KAAKK,gBAAkBW,EAAQ7C,OAE1EG,EAAKwD,YACP9B,KAAK+B,gBAAgBzD,GACrBmC,EAAK/I,GAAGM,GAAKsG,GAKnB0B,KAAKQ,MAAMC,KAAOA,EAClBT,KAAKQ,MAAME,SAAWA,2CAGRpC,GAAM,IAAA0D,EAAAhC,KACpB,KAAM1B,EAAK2D,MAAMjC,KAAKI,IAAII,MAAM0B,OAAQ,CACtC,IAAMC,EAAUnC,KAAKI,IAAIY,QAAQoB,OAAOnK,KAAKsG,MAAMD,EAAK5G,GAAIO,KAAKsG,MAAMD,EAAKtG,GAAIsG,EAAKH,MAErF6B,KAAKI,IAAII,MAAM0B,MAAM5D,EAAK2D,IAAM,IAAII,MACpCrC,KAAKI,IAAII,MAAM0B,MAAM5D,EAAK2D,IAAIK,YAAc,YAC5CtC,KAAKI,IAAII,MAAM0B,MAAM5D,EAAK2D,IAAIM,OAASjE,EAAK2D,GAC5CjC,KAAKI,IAAII,MAAM0B,MAAM5D,EAAK2D,IAAIO,IAAML,EACpCnC,KAAKI,IAAII,MAAM0B,MAAM5D,EAAK2D,IAAIQ,QAAS,EACvCzC,KAAKI,IAAII,MAAM0B,MAAM5D,EAAK2D,IAAIS,OAAS,WACrCV,EAAK5B,IAAII,MAAM0B,MAAM5D,EAAK2D,IAAIQ,QAAS,GAI3CzC,KAAKI,IAAII,MAAM0B,MAAM5D,EAAK2D,IAAIU,eAAgB,IAAIC,MAAOC,4CAGjDlF,GACR,IAAMmF,EAAc9C,KAAKI,IAAII,MAAMgB,iBAAiB,GAC9CuB,EAAe/C,KAAKI,IAAII,MAAMgB,iBAAiB,GAE/CnC,EAAWW,KAAKI,IAAIY,QAAQ3B,SAAW1B,EAEvCqF,EAAe,CACnB3D,EAAW,EAAKW,KAAKQ,MAAMG,mBAAmB,GAAKtB,EACnDA,EAAW,EAAKW,KAAKQ,MAAMG,mBAAmB,GAAKtB,GAGrDW,KAAKO,QAAQ0C,UAAY,OACzBjD,KAAKO,QAAQ2C,SAAS,EAAG,EAAGJ,EAAaC,GAQzC,IANA,IAAMzB,EAAkBtB,KAAKuB,cAAcuB,GACrCrB,EAAgBzB,KAAKuB,cAAcwB,GAEnCI,EAAsB7B,EAAkBjC,EAAYyD,EACpDM,EAAoB3B,EAAgBpC,EAAY0D,EAE7C/K,EAAI,EAAGA,EAAIyJ,EAAezJ,IACjC,IAAK,IAAIN,EAAI,EAAGA,EAAI4J,EAAiB5J,IAAK,CACxC,IAAM4G,EAAO0B,KAAKQ,MAAMC,KAAK/I,GAAGM,GAEhC,GAAIsG,EAAM,CACR,IAAMiB,EAAQS,KAAKI,IAAII,MAAM6C,WAAW,GAAKL,EAAa,IACrDtL,EAAI2H,EAAW8D,EAAqB,GAEnC1D,EAAQO,KAAKI,IAAII,MAAM6C,WAAW,GAAKL,EAAa,IACrDhL,EAAIqH,EAAW+D,EAAmB,GAEvC,IACMpD,KAAKI,IAAII,MAAM0B,MAAM5D,EAAK2D,IAAIQ,OAChCzC,KAAKO,QAAQ+C,UAAUtD,KAAKI,IAAII,MAAM0B,MAAM5D,EAAK2D,IAAK1C,EAAOE,EAAOJ,EAAUA,GAE9EW,KAAKuD,sBAAsBhE,EAAOE,EAAOJ,GAE3C,MAAOmE,GACPxD,KAAKuD,sBAAsBhE,EAAOE,EAAOJ,GAGvCW,KAAKI,IAAIY,QAAQyC,QACnBzD,KAAKO,QAAQmD,YAAc,QAC3B1D,KAAKO,QAAQoD,WAAWpE,EAAOE,EAAOJ,EAAUA,KAMpDW,KAAKI,IAAIY,QAAQyC,QACnBzD,KAAKO,QAAQ0C,UAAY,uBACzBjD,KAAKO,QAAQqD,YACb5D,KAAKO,QAAQsD,IAAIf,EAAc,EAAGC,EAAe,EAAG,EAAG,EAAG,EAAI9K,KAAK0G,IACnEqB,KAAKO,QAAQuD,sDAIKpM,EAAGM,EAAG+L,GAC1B,IAAMC,EAAYD,EAAO,EAEzB/D,KAAKO,QAAQqD,YACb,IAAK,IAAIK,EAAQD,EAAWC,EAAQF,EAAME,GAASD,EACjD,IAAK,IAAIE,EAAQF,EAAWE,EAAQH,EAAMG,GAASF,EACjDhE,KAAKO,QAAQ4D,OAAOzM,EAAGM,EAAIkM,GAC3BlE,KAAKO,QAAQ6D,OAAO1M,EAAIqM,EAAM/L,EAAIkM,GAElClE,KAAKO,QAAQ4D,OAAOzM,EAAIuM,EAAOjM,GAC/BgI,KAAKO,QAAQ6D,OAAO1M,EAAIuM,EAAOjM,EAAI+L,GAGvC/D,KAAKO,QAAQmD,YAAc,OAC3B1D,KAAKO,QAAQ8D,SAEbrE,KAAKO,QAAQmD,YAAc,OAC3B1D,KAAKO,QAAQoD,WAAWjM,EAAGM,EAAG+L,EAAMA,8CASpC,IALA,IAAMzC,EAAkBtB,KAAKuB,cAAcvB,KAAKI,IAAII,MAAMgB,iBAAiB,IACrEC,EAAgBzB,KAAKuB,cAAcvB,KAAKI,IAAII,MAAMgB,iBAAiB,IAErE8C,EAAa,EAAGC,EAAc,EAEzBvM,EAAI,EAAGA,EAAIyJ,EAAezJ,IACjC,IAAK,IAAIN,EAAI,EAAGA,EAAI4J,EAAiB5J,IAAK,CACxC,IAAM4G,EAAO0B,KAAKQ,MAAMC,KAAK/I,GAAGM,GAE5BsG,GACFgG,IAGF,IAAME,EAAalG,GAAQ0B,KAAKI,IAAII,MAAM0B,MAAM5D,EAAK2D,IAEjDuC,GAAcA,EAAW/B,QAC3B8B,IAKN,OAAOA,EAAcD,iNC3MJG,aACnB,SAAAA,EAAYrF,EAAQjB,EAAMuG,EAAYrF,EAAUmC,EAAkBmD,EAActB,gGAAYuB,CAAA5E,KAAAyE,GAC1FzE,KAAK6E,QAAUzF,EACfY,KAAKE,MAAQ/B,EACb6B,KAAK8E,YAAcJ,EACnB1E,KAAK+E,UAAY1F,EACjBW,KAAKgF,kBAAoBxD,EACzBxB,KAAKiF,cAAgBN,EACrB3E,KAAKkF,YAAc7B,wDAInB,OAAOrD,KAAK6E,qCAIZ,OAAO7E,KAAKE,yCAIZ,OAAOF,KAAK8E,6CAIZ,OAAO9E,KAAK+E,mDAIZ,OAAO/E,KAAKgF,uDAIZ,OAAOhF,KAAKiF,iDAIZ,OAAOjF,KAAKkF,2NClCKC,aACnB,SAAAA,EAAYC,gGAAYC,CAAArF,KAAAmF,GACtBnF,KAAKsF,SAAW,GAChBtF,KAAKuF,gBAAkB,KACvBvF,KAAKwF,kBAAoB,KACzBxF,KAAKyF,kBAAoB,wEAWPC,GAClB,IAAIC,EAAaD,EAASvH,KAQ1B,OANIuH,EAAShB,WAAagB,EAASvH,KACjCwH,EAAa1N,KAAKsG,MAAMmH,EAASvH,MACxBuH,EAAShB,WAAagB,EAASvH,OACxCwH,EAAa1N,KAAK8I,KAAK2E,EAASvH,OAG3BwH,iCAGFpF,EAASmF,EAAUE,GAAkC,IAAvBC,EAAuBxH,UAAAhG,OAAA,QAAA+D,IAAAiC,UAAA,IAAAA,UAAA,GACpDsH,EAAa3F,KAAK8F,oBAAoBJ,GAEtCK,EAAWJ,EACbD,EAASvH,KAAOwH,EAChB,EAEEhI,EAAqB,IAAboI,EACV9N,KAAKC,IAAI,EAAG6N,GACZ,EAMJ,IAJIF,GAAiB7F,KAAKgG,eAAeN,EAAUK,KACjD/F,KAAKiG,sBAAsBP,EAAUE,GAGnCjI,EAAQ,KAAOA,EAAQ,GAAK,CAC9B,IAAMuI,EAAqB,CACzBR,EAASrC,WAAW,GAAMqC,EAASf,aAAa,IAAMhH,EAAQ,GAC9D+H,EAASrC,WAAW,GAAMqC,EAASf,aAAa,IAAMhH,EAAQ,IAG1DwI,EAAuB,CAC3BT,EAASlE,iBAAiB,GAAK7D,EAC/B+H,EAASlE,iBAAiB,GAAK7D,GAGjC4C,EAAQ+C,UACNtD,KAAKuF,gBACLW,EAAmB,GAAIA,EAAmB,GAC1CC,EAAqB,GAAIA,EAAqB,4CAKrCT,EAAUK,GACvB,IAAMK,EAAmBpG,KAAKwF,oBAAsBE,EAAStG,OAC3DiH,EAA+B,IAAbN,GAAkB/F,KAAKyF,oBAAsBC,EAASvH,KAE1E,OAAgC,OAAzB6B,KAAKuF,iBAA4Ba,GAAoBC,gDAGxCX,EAAUE,GAC9B5F,KAAKyF,kBAAoBC,EAASvH,KAClC6B,KAAKwF,kBAAoBE,EAAStG,OAElC,IAAMmB,EAAUP,KAAKsG,sBAAsBZ,EAASlE,kBAC7BxB,KAAKuG,kBAAkBX,GAE/BY,QAAQ,SAAAC,GACrB,IAAMC,EAAWzI,EAAe0I,cAC9BF,EAAOG,OACPlB,EAAStG,OACTsG,EAASvH,KACTuH,EAASrG,UAGXoH,EAAOI,OAAOtG,EAAS,CACrBmF,EAASf,aAAa,GAAK+B,EAAS,GACpChB,EAASf,aAAa,GAAK+B,EAAS,IACnChB,EAASvH,sDAIMqD,GAKpB,OAJAxB,KAAKuF,gBAAkBuB,SAASC,cAAc,UAC9C/G,KAAKuF,gBAAgByB,MAAQxF,EAAiB,GAC9CxB,KAAKuF,gBAAgB0B,OAASzF,EAAiB,GAExCxB,KAAKuF,gBAAgB2B,WAAW,gDAGvBC,GAChB,OAAOnH,KAAKoH,QAAQC,OAAO,SAAAZ,GACzB,OAAOA,EAAOG,OAAO,IAAMO,EAAOG,GAAG,IAAMb,EAAOG,OAAO,IAAMO,EAAOI,GAAG,IACpEd,EAAOG,OAAO,IAAMO,EAAOG,GAAG,IAAMb,EAAOG,OAAO,IAAMO,EAAOI,GAAG,8CAI1D7B,EAAUE,GACzB,OAAO5F,KAAKuG,kBAAkBX,GAAWxF,IAAI,SAAAqG,GAC3C,IAAMC,EAAWzI,EAAe0I,cAC9BF,EAAOG,OACPlB,EAAStG,OACTsG,EAASvH,KACTuH,EAASrG,UAGLmI,EAAaf,EAAO1C,KACpB0D,EAAehB,EAAOiB,OAE5B,MAAO,CACLP,OAAQ,CACNzP,EAAGgO,EAASf,aAAa,GAAK+B,EAAS,GAAKhB,EAASrC,WAAW,GAAMmE,EAAW,GAAK,EAAKC,EAAa,GACxGzP,EAAG0N,EAASf,aAAa,GAAK+B,EAAS,GAAKhB,EAASrC,WAAW,GAAMmE,EAAW,GAAK,EAAKC,EAAa,GACxGT,MAAOQ,EAAW,GAClBP,OAAQO,EAAW,IAErBf,4CApHJ,OAAOzG,KAAKsF,uBAGF8B,GACVpH,KAAKsF,SAAW8B,uCCfPO,EAAoB,CAI/BvF,OAAQ,SAAC1K,EAAGM,EAAG6G,GAAP,2CAAAvC,OAAkDuC,EAAlD,KAAAvC,OAAuD5E,EAAvD,KAAA4E,OAA4DtE,EAA5D,SACRmG,KAAM,GACNiB,OAAQ,CAAC,WAAY,WACrBwI,YAAa,+BAKbC,yBAAyB,EAOzBC,iBAAkB,WAKlBzI,SAAU,IAMV0I,0BAA2B,EAM3BC,mBAAoB,IAMpBC,uBAAwB,IAMxBC,uBAAwB,IAKxBC,oBAAqB,IAMrBC,mBAAoB,IAQpBnH,mBAAoB,EAMpBwC,OAAO,EAMPhF,KAAK,GAGM4J,EAAuB,CAKlCC,MAAO,uBAKPC,KAAM,SAMNC,MAAO,KAQPd,OAAQ,CAAC,EAAG,GAMZe,cAAc,EAMdC,cAAc,EAOdhF,YAAa,2BAMbiF,UAAW,KAGAC,EAAwB,CAInCF,cAAc,EAMdhF,YAAa,wBAMbmF,SAAU,GAMVF,UAAW,IAKXG,YAAY,EAMZ7F,UAAW,qBAKX8F,aAAa,GAGFC,EAA6B,CACxCtF,YAAa,MACbiF,UAAW,8KC3KQM,aAEnB,SAAAA,EAAYC,EAAQlI,GAClB,+FAD2BmI,CAAAnJ,KAAAiJ,IACtBC,IAAWA,EAAOhC,WACrB,MAAM,IAAIkC,MAAM,gCAGlBpJ,KAAKkJ,OAASA,EACdlJ,KAAKO,QAAUP,KAAKkJ,OAAOhC,WAAW,MAEtClH,KAAKgB,QAAU/K,OAAOoT,OAAO,GAAI1B,EAAmB3G,GAEpDhB,KAAKsJ,kBACLtJ,KAAKuJ,eAELvJ,KAAKwJ,cAAgB,KAKrBxJ,KAAKyJ,gBAAkB,KACvBzJ,KAAK0J,cAAgB,KACrB1J,KAAK2J,iBAAmB,KACxB3J,KAAK4J,eAAiB,KACtB5J,KAAK6J,mBAAqB,KAC1B7J,KAAK8J,iBAAmB,KACxB9J,KAAK+J,YAAc,KAEnB/J,KAAKgK,KAAOhK,KAAKgK,KAAKjT,KAAKiJ,MAC3B7K,OAAO8U,sBAAsBjK,KAAKgK,uEAIlChK,KAAKQ,MAAQ,CACXgB,iBAAkB,CAACxB,KAAKkJ,OAAOlC,MAAOhH,KAAKkJ,OAAOjC,QAClD/E,MAAO,GACPmB,WAAY,CAAC,EAAG,GAChB6G,iBAAkB,CAAC,EAAG,GACtBC,yBAAyB,EACzBC,mBAAoB,KACpBC,kBAAmB,KACnBC,wBAAyB,KACzBC,UAAWvK,KAAKgB,QAAQ7C,KACxBuG,WAAY1E,KAAKgB,QAAQ7C,KACzBqM,mBAAoB,KACpB7M,MAAO,EACP8M,mBAAoB,KACpBC,gBAAiB,GACjBC,eAAgB,IAAIxF,EAAenF,KAAKgB,QAAQ8G,kBAChD8C,SAAU,GACVC,WAAY,CACV,IAAI1K,EAAUH,OAEhB8K,cAAe,CAAEpT,GAAI,EAAGM,GAAI,GAC5B+S,aAAa,EACbC,sBAAsB,qCAKxB,OAAOhL,KAAKgB,QAAQ7C,qCAGdA,GACF6B,KAAKiL,iBAAiB9M,IAAS6B,KAAKkL,wBACtC/M,EAAOlG,KAAKmJ,MAAMjD,GAElB6B,KAAKQ,MAAMqK,WAAW5Q,KAAK,IAAIkG,EAAUH,KAAM7B,IAE/C6B,KAAKQ,MAAM8J,wBAA0BnV,OAAOgW,YAAYC,MACxDpL,KAAKQ,MAAMgK,mBAAqBrV,OAAOgW,YAAYC,MACnDpL,KAAKQ,MAAMkE,WAAavG,EACxB6B,KAAKQ,MAAM+J,UAAYvK,KAAKgB,QAAQ7C,wCAI9BwB,GACR,IAAKhG,MAAM0R,QAAQ1L,IAA2B,IAAjBA,EAAMtH,OACjC,MAAM,IAAI+Q,MAAM,+CAGlBzJ,EAAQA,EAAMS,IAAI,SAAAT,GAAK,OAAI2L,WAAW3L,KAEtCK,KAAKQ,MAAM4J,mBAAqBjV,OAAOgW,YAAYC,MACnDpL,KAAKQ,MAAM0J,iBAAmBvK,EAC9BK,KAAKQ,MAAM2J,yBAA0B,8CAGnBzS,EAAGM,GAAoB,IAAjBuT,IAAiBlN,UAAAhG,OAAA,QAAA+D,IAAAiC,UAAA,KAAAA,UAAA,GACzC2B,KAAK+J,aAAe/J,KAAK+J,YAAY,CAACrS,EAAGM,IAErCuT,GACFvL,KAAKQ,MAAM4J,mBAAqBjV,OAAOgW,YAAYC,MAEnDpL,KAAKQ,MAAM0J,iBAAmBjM,EAAeuN,cAC3C,CAAC9T,EAAGM,GACJgI,KAAKgB,QAAQ5B,OACbY,KAAKgB,QAAQ7C,KACb6B,KAAKgB,QAAQ3B,UAGfW,KAAKQ,MAAM2J,yBAA0B,IAErCnK,KAAKQ,MAAM0J,iBAAmB,CAACxS,EAAGM,GAClCgI,KAAKQ,MAAM2J,yBAA0B,EAErCnK,KAAKQ,MAAM6C,WAAarD,KAAKQ,MAAM0J,2DAItB/L,GACf,OAAOA,GAAQ,GAAKA,GAAQ,iDAI5B,OAAK6B,KAAKQ,MAAM8J,yBAIJnV,OAAOgW,YAAYC,MACUpL,KAAKQ,MAAM8J,wBAEhBtK,KAAKgB,QAAQoH,6DAGjCqD,EAAWC,EAAWC,EAAOC,GAC7C,OAASH,EAAYC,IAAcC,EAAQC,GAAU,2CAGxC,IAAA5J,EAAAhC,KACbA,KAAKkJ,OAAO2C,iBAAiB,QAAS,SAAAC,GACpCA,EAAMC,iBAEFD,EAAME,OAAS,EACjBhK,EAAKiK,QAAQjK,EAAKhB,QAAQ7C,KAAO,GACxB2N,EAAME,QAAU,GACzBhK,EAAKiK,QAAQjK,EAAKhB,QAAQ7C,KAAO,KAIrC6B,KAAKkJ,OAAO2C,iBAAiB,WAAY,SAAAC,GAIvC,GAHAA,EAAMC,iBACN/J,EAAKkK,oBAAoBJ,IAEpB9J,EAAKmK,4BAA4BL,EAAO,YAAa,CACxD,IAAMnH,EAAe3C,EAAKoK,kBAE1BpK,EAAKqK,sBACDrK,EAAKxB,MAAMsK,cAAcpT,EAAIiN,EAAa,MAC1C3C,EAAKxB,MAAMsK,cAAc9S,EAAI2M,EAAa,KAG9C3C,EAAKiK,QAAQjK,EAAKhB,QAAQ7C,KAAO,MAIrC6B,KAAKkJ,OAAO2C,iBAAiB,YAAa,SAAAC,GACxCA,EAAMC,iBACN/J,EAAKkK,oBAAoBJ,GAEpB9J,EAAKmK,4BAA4BL,EAAO,eAC3C9J,EAAKxB,MAAMkK,gBAAkB,GAE7B1I,EAAKxB,MAAM6J,kBAAoB,CAC7BrI,EAAKxB,MAAMsK,cAAcpT,EAAIsK,EAAKxB,MAAM6C,WAAW,GACnDrB,EAAKxB,MAAMsK,cAAc9S,EAAIgK,EAAKxB,MAAM6C,WAAW,OAKzDrD,KAAKkJ,OAAO2C,iBAAiB,UAAW,SAAAC,GAItC,GAHAA,EAAMC,iBACN/J,EAAKkK,oBAAoBJ,GAEpB9J,EAAKxB,MAAM6J,kBAET,CACL,IAAM3S,IAAMsK,EAAKxB,MAAM6J,kBAAkB,GAAKrI,EAAKxB,MAAMsK,cAAcpT,GACjEM,IAAMgK,EAAKxB,MAAM6J,kBAAkB,GAAKrI,EAAKxB,MAAMsK,cAAc9S,GAMvE,GAJAgK,EAAKxB,MAAM6J,kBAAoB,KAEIpS,KAAKiE,IAAIxE,IAAM,GAAKO,KAAKiE,IAAIlE,IAAM,EAGpEgK,EAAKmK,4BAA4BL,EAAO,gBAExC,GAAiC,IAA7B9J,EAAKxB,MAAM6C,WAAW,IAAyC,IAA7BrB,EAAKxB,MAAM6C,WAAW,GAAU,CACpE,IACMiJ,EADMnX,OAAOgW,YAAYC,MACDpJ,EAAKhB,QAAQiH,uBAErCsE,EAAuBvK,EAAKxB,MAAMkK,gBACrCrD,OAAO,SAAAmF,GAAS,OAAIA,EAAU,GAAKF,IACnClM,IAAI,SAAAoM,GAAS,OAAIA,EAAU,KAOxBC,EALcF,EAAqBG,OACvC,SAACC,EAAaC,GAAd,OAA2BD,EAAcC,GACzC,GAGoCL,EAAqBlU,OAE3D,GAAIoU,GAAmBzK,EAAKhB,QAAQkH,uBAAwB,CAC1D,IAAI2E,EAAaJ,EAAkBzK,EAAKhB,QAAQkH,uBAC5ClG,EAAKhB,QAAQ+G,0BAEjB8E,EAAa5U,KAAKa,IAAI+T,EAAY7K,EAAKhB,QAAQgH,oBAE/ChG,EAAKqK,oBACH3U,EAAImV,EACJ7U,EAAI6U,QAGN7K,EAAK8K,qBAtCX9K,EAAKmK,4BAA4BL,EAAO,aA6C5C9L,KAAKkJ,OAAO2C,iBAAiB,YAAa,SAAAC,GAIxC,GAHAA,EAAMC,iBACN/J,EAAKkK,oBAAoBJ,GAErB9J,EAAKxB,MAAM6J,kBAAmB,CAChC,IAAM3S,IAAMsK,EAAKxB,MAAM6J,kBAAkB,GAAKrI,EAAKxB,MAAMsK,cAAcpT,GACjEM,IAAMgK,EAAKxB,MAAM6J,kBAAkB,GAAKrI,EAAKxB,MAAMsK,cAAc9S,GAEjEoT,EAAMjW,OAAOgW,YAAYC,MAEzB2B,EAAK/K,EAAKgL,kBAAkBhL,EAAKxB,MAAM6C,WAAW,GAAI3L,EAAG0T,EAAKpJ,EAAKxB,MAAMiK,oBACzEwC,EAAKjL,EAAKgL,kBAAkBhL,EAAKxB,MAAM6C,WAAW,GAAIrL,EAAGoT,EAAKpJ,EAAKxB,MAAMiK,oBAEzEmC,EAAW3U,KAAKmJ,MAAMnJ,KAAKiV,KAAMH,EAAKA,EAAOE,EAAKA,IAExDjL,EAAKxB,MAAMkK,gBAAgBzQ,KAAK,CAACmR,EAAKwB,IAEtC5K,EAAKqK,oBAAoB3U,EAAGM,GAAG,GAE/BgK,EAAKxB,MAAMiK,mBAAqBtV,OAAOgW,YAAYC,WAEnDpJ,EAAKmK,4BAA4BL,EAAO,aAG1C,OAAO,IAGT9L,KAAKkJ,OAAO2C,iBAAiB,aAAc,SAAAC,GACrC9J,EAAKhB,QAAQ6G,0BACf7F,EAAKxB,MAAM2M,cAAe,GAG5BnL,EAAKkK,oBAAoB,QAG3BlM,KAAKkJ,OAAO2C,iBAAiB,aAAc,SAAAC,GACrC9J,EAAKhB,QAAQ6G,0BACf7F,EAAKxB,MAAM2M,cAAe,sDAM9B,OAAwC,OAAjCnN,KAAKQ,MAAM6J,uEAIlB,OAAOrK,KAAK4J,gBAAkB5J,KAAK2J,6DAGjBmC,GAClB,GAAIA,EAAO,CACT,IAAMsB,EAAOpN,KAAKkJ,OAAOmE,wBAEzBrN,KAAKQ,MAAMsK,cAAgB,CACzBpT,EAAGoU,EAAMwB,QAAUF,EAAKG,KACxBvV,EAAG8T,EAAM0B,QAAUJ,EAAKK,UAG1BzN,KAAKQ,MAAMsK,cAAgB,CACzBpT,GAAI,EACJM,GAAI,uCAKE0V,GACV,OAAOA,GAAQ,EAAIA,8CAInB,IAAMxD,EAAmBlK,KAAKQ,MAAM2J,wBAChClM,EAAe0I,cACf3G,KAAKQ,MAAM0J,iBACXlK,KAAKgB,QAAQ5B,OACbY,KAAKgB,QAAQ7C,KACb6B,KAAKgB,QAAQ3B,UAEbW,KAAKQ,MAAM0J,iBAIf,GAFmClK,KAAKQ,MAAM6C,WAAWvJ,KAAK,OAASoQ,EAAiBpQ,KAAK,KAE7D,CAC9B,IAAM6T,EAAYxY,OAAOgW,YAAYC,MAE/BwC,EAAW3V,KAAKe,IAAI2U,EAAY3N,KAAKQ,MAAM4J,mBAAoB,GAC/DyD,EAAa7N,KAAK8N,YAAYF,EAAW5N,KAAKgB,QAAQmH,qBAG1DnI,KAAKQ,MAAM6C,WADTwK,GAAc,KAAQA,EAAa,EACb3D,EAEA,CACtBlK,KAAKQ,MAAM6C,WAAW,IAAM6G,EAAiB,GAAKlK,KAAKQ,MAAM6C,WAAW,IAAMwK,EAC9E7N,KAAKQ,MAAM6C,WAAW,IAAM6G,EAAiB,GAAKlK,KAAKQ,MAAM6C,WAAW,IAAMwK,GAIrD7N,KAAKQ,MAAM6C,WAAWvJ,KAAK,OAASoQ,EAAiBpQ,KAAK,OAGrFkG,KAAKQ,MAAM2J,yBAA0B,EAErCnK,KAAK8M,wDAMT,IAAMiB,EAAS9P,EAAeuN,cAC5BxL,KAAKQ,MAAM6C,WACXrD,KAAKgB,QAAQ5B,OACbY,KAAKgB,QAAQ7C,KACb6B,KAAKgB,QAAQ3B,UAGfW,KAAKqM,oBAAoB,EAAG,GAAG,GAC/BrM,KAAKgB,QAAQ5B,OAAS2O,EAEtB/N,KAAK6J,oBAAsB7J,KAAK6J,mBAAmB7J,KAAKgB,QAAQ7C,KAAM6B,KAAKgB,QAAQ5B,6CAInF,GAAIY,KAAKgB,QAAQ7C,OAAS6B,KAAKQ,MAAMkE,WAAY,CAC/C,IAAMkJ,EAAW3V,KAAKe,IAAI7D,OAAOgW,YAAYC,MAAQpL,KAAKQ,MAAMgK,mBAAoB,GAC9EqD,EAAa7N,KAAK8N,YAAYF,EAAW5N,KAAKgB,QAAQmH,qBAExD6F,EAAuB/V,KAAKiE,IAAI8D,KAAKQ,MAAMkE,WAAa1E,KAAKQ,MAAM+J,WAEnEvK,KAAKQ,MAAMkE,YAAc1E,KAAKQ,MAAM+J,YACtCyD,IAAyB,GAG3B,IAAMC,EAAcD,EAAuBH,EACrCK,EAAgBlO,KAAKgB,QAAQmH,oBAAsByF,EAEzD5N,KAAKgB,QAAQ7C,KAAO+P,GAAiB,EACjClO,KAAKQ,MAAMkE,WACV1E,KAAKQ,MAAM+J,UAAY0D,EAE5B,IAAME,EAAclW,KAAKmJ,MAAMpB,KAAKgB,QAAQ7C,MACtCiQ,EAAOpO,KAAKgB,QAAQ7C,KAAOgQ,EAEjCnO,KAAKQ,MAAM7C,MAAQ1F,KAAKC,IAAI,EAAGkW,GAE3BpO,KAAKgB,QAAQ7C,OAAS6B,KAAKQ,MAAMkE,aAEnC1E,KAAKQ,MAAMqK,WAAWwD,QACtBrO,KAAKQ,MAAMqK,WAAW,GAAGxK,eAAiB,KAE1CL,KAAK8J,kBAAoB9J,KAAK8J,iBAAiB9J,KAAKgB,QAAQ7C,KAAM6B,KAAKgB,QAAQ5B,cAGjFY,KAAKQ,MAAM7C,MAAQ,2CAIN,IAAA2Q,EAAAtO,KACTuO,EAAWtY,OAAOuY,OAAOxO,KAAKQ,MAAM0B,OAE1C,GAAIqM,EAASlW,OAAS2H,KAAKyO,iBAAkB,CAC3C,IAAMC,GAAuB,IAAI9L,MAAOC,UAAY,IAE9C8L,EAAkBJ,EACrBlH,OAAO,SAAA/I,GAAI,OAAIA,EAAKqE,cAAgB+L,IACpCE,KAAK,SAACrX,EAAGC,GAAJ,SAAaD,EAAEoL,cAAgBnL,EAAEmL,iBAEnCkM,EAAqB7O,KAAKyO,kBAAoBF,EAASlW,OAASsW,EAAgBtW,QAEtFsW,EACGG,OAAOH,EAAgBtW,OAASwW,GAChCrI,QAAQ,SAAAlI,GACPA,EAAKkE,IAAM,UACJ8L,EAAK9N,MAAM0B,MAAM5D,EAAKiE,sDAMnC,OAAO,IAAIkC,EACTzE,KAAKgB,QAAQ5B,OACbY,KAAKgB,QAAQ7C,KACb6B,KAAKQ,MAAMkE,WACX1E,KAAKgB,QAAQ3B,SACbW,KAAKQ,MAAMgB,iBACXxB,KAAKoM,kBACLpM,KAAKQ,MAAM6C,qDAKb,OAAO,2CAIP,GAAIrD,KAAKQ,MAAMuK,YAGb,OAFA/K,KAAKQ,MAAMuK,aAAc,GAElB,EAGT,IAAMgE,EAAYC,KAAKC,UAAU,CAACjP,KAAKQ,MAAOR,KAAKgB,UAEnD,OAAIhB,KAAKwJ,gBAAkBuF,IACzB/O,KAAKwJ,cAAgBuF,GAEd,kCAcT,GAPA/O,KAAKgB,QAAQvC,KAAOyQ,QAAQzQ,IAAIuB,KAAKmP,oBAErCnP,KAAKoP,mBACLpP,KAAKqP,aACLrP,KAAKQ,MAAMqK,WAAWrE,QAAQ,SAAA8I,GAAS,OAAIA,EAAUC,kBACrDvP,KAAKwP,iBAEDxP,KAAKyP,eAAgB,CACnBzP,KAAKQ,MAAMqK,WAAWxS,OAAS,GAEjC2H,KAAKQ,MAAMqK,WAAW,GAAG6E,UAAU1P,KAAKQ,MAAM7C,OAGhD,IAAM+H,EAAW1F,KAAKmP,mBAEtBnP,KAAK2P,eAAejK,GACpB1F,KAAK4P,cAAclK,GACnB1F,KAAK6P,iBACL7P,KAAK8P,oBAGP3a,OAAO8U,sBAAsBjK,KAAKgK,6CAIlC,IAAMrF,EAAe3E,KAAKoM,kBAgB1B,MAAO,CACL9E,GAfSrJ,EAAeuN,cACxB,CAAC7G,EAAa,GAAIA,EAAa,IAC/B3E,KAAKgB,QAAQ5B,OACbY,KAAKgB,QAAQ7C,KACb6B,KAAKgB,QAAQ3B,UAWTkI,GARKtJ,EAAeuN,cACxB,EAAE7G,EAAa,IAAKA,EAAa,IACjC3E,KAAKgB,QAAQ5B,OACbY,KAAKgB,QAAQ7C,KACb6B,KAAKgB,QAAQ3B,qDASf,MAAO,CACLW,KAAKQ,MAAMgB,iBAAiB,GAAK,EACjCxB,KAAKQ,MAAMgB,iBAAiB,GAAK,yCAIvBkE,GACZ1F,KAAKQ,MAAMmK,eAAe9D,OAAO7G,KAAKO,QAASmF,EAAU1F,KAAK+P,eAAgB/P,KAAKQ,MAAMwK,sBACzFhL,KAAKQ,MAAMwK,sBAAuB,yCAGrBtF,GAAU,IAAAsK,EAAAhQ,KACvBA,KAAKQ,MAAMoK,SAASxK,IAAI,SAAA6P,GACtBA,EAAQpJ,OAAOmJ,EAAKzP,QAASmF,GAEzBsK,EAAKE,+BAAiCF,EAAKG,0BAC7CF,EAAQG,gBAAgBJ,EAAKzP,QAASmF,EAAUsK,EAAKxP,MAAMsK,qEAKrCgB,EAAOhW,GAAM,IAAAua,EAAArQ,KACjCsQ,EAAiBtQ,KAAKuQ,oBAAoBlJ,OAAO,SAAAmJ,GAAI,OAAIH,EAAKI,kBAAkBD,EAAKrJ,UAQrFuJ,GAPyBJ,EAAejY,QAAU,IAAM2H,KAAKyJ,iBAAmBzJ,KAAK0J,eAGvF1J,KAAKQ,MAAMmK,eAAegG,iBAAiB3Q,KAAKmP,mBAAoBnP,KAAK+P,gBACxE1I,OAAO,SAAAmJ,GAAI,OAAIH,EAAKI,kBAAkBD,EAAKrJ,UAC5C,IAEwB,IAAM,KAElC,GAAa,YAATrR,EAAoB,CACtB,GAAIwa,EAAejY,OAAS,EAAG,CAC7B,IAAMuY,EAAgBN,EAAe,GAErCtQ,KAAKiM,QAAgC,MAAxB2E,EAAcC,MACvB7Q,KAAKgB,QAAQ7C,KAAO,EACpB6B,KAAKgB,QAAQ7C,KAAO,GAGtB6B,KAAKyJ,iBAAmBiH,GAC1B1Q,KAAKyJ,gBAAgBiH,EAAYjK,aAG/BzG,KAAK0J,eAAiBgH,GACxB1Q,KAAK0J,cAAcgH,EAAYjK,QAInC,IAAIqK,EAA2BR,EAAejY,OAAS,GAAKqY,EAExDK,GAAiB,EAErB,GAAI/Q,KAAKkQ,+BAAiClQ,KAAKmQ,2BAA6BW,EAA0B,CACpG,IAAIlG,EAAW,GAETlF,EAAW1F,KAAKmP,mBAWtB,GAFA4B,GAPAnG,EAAW5K,KAAKQ,MAAMoK,SAASxK,IAAI,SAAA6P,GACjC,MAAO,CACLA,UACAe,eAAgBf,EAAQG,gBAAgB,KAAM1K,EAAU2K,EAAK7P,MAAMsK,kBAEpEzD,OAAO,SAAA4I,GAAO,OAAIA,EAAQe,eAAe3Y,OAAS,KAE3BA,OAAS,EAEf,CAClB,IAAM4Y,EAAyB,YAATnb,EAClBkK,KAAK2J,iBACL3J,KAAK4J,eAELqH,GACFrG,EAASxK,IAAI,SAAA6P,GAAO,OAAIA,EAAQe,eAAe5Q,IAAI,SAAAoQ,GAAI,OAAIS,EAAaT,EAAMP,EAAQA,QAAQiB,WAWpG,OANAlR,KAAKkJ,OAAOiI,MAAMC,OAASN,GAA4BC,EACnD,UACA,OAIGD,8CAOP,MAAO,CACL,CACE3J,OAAQ,CACNzP,EANS,EAOTM,EAPS,EAQTgP,MAPO,GAQPC,OARO,IAUT4J,MAAO,KAET,CACE1J,OAAQ,CACNzP,EAfS,EAgBTM,EAAGqZ,GACHrK,MAhBO,GAiBPC,OAjBO,IAmBT4J,MAAO,+CAKI,IAAAS,EAAAtR,KACXA,KAAKQ,MAAM2M,cACbnN,KAAKuQ,oBAAoBnQ,IAAI,SAAAoQ,GAAI,OAAIc,EAAKC,cAAcf,EAAKrJ,OAAQqJ,EAAKK,+CAIhE1J,EAAQ0J,GAIpB7Q,KAAKO,QAAQ0C,UAAYjD,KAAKyQ,kBAAkBtJ,GAC5C,2BACA,qBAEJnH,KAAKwR,iBAAiBrK,EAAOzP,EAAGyP,EAAOnP,EAAGmP,EAAOH,MAAOG,EAAOF,OAPhD,IAUfjH,KAAKO,QAAQkR,KAAO,oBACpBzR,KAAKO,QAAQmR,UAAY,SACzB1R,KAAKO,QAAQoR,aAAe,SAC5B3R,KAAKO,QAAQ0C,UAAY,OAEzBjD,KAAKO,QAAQqR,SACXf,EACA1J,EAAOzP,EAAKyP,EAAOH,MAAQ,EAC3BG,EAAOnP,EAAKmP,EAAOF,OAAS,6CAIdE,GAChB,OAAOnH,KAAKQ,MAAMsK,cAAcpT,GAAKyP,EAAOzP,GACvCsI,KAAKQ,MAAMsK,cAAcpT,GAAKyP,EAAOzP,EAAIyP,EAAOH,OAChDhH,KAAKQ,MAAMsK,cAAc9S,GAAKmP,EAAOnP,GACrCgI,KAAKQ,MAAMsK,cAAc9S,GAAKmP,EAAOnP,EAAImP,EAAOF,mDAMrDjH,KAAKO,QAAQkR,KAAO,uBACpBzR,KAAKO,QAAQmR,UAAY,OACzB1R,KAAKO,QAAQoR,aAAe,aAE5B,IAAME,EAAa7R,KAAKO,QAAQuR,YAAY9R,KAAKgB,QAAQ4G,aAEnDlQ,EAAIsI,KAAKQ,MAAMgB,iBAAiB,GAAKqQ,EAAW7K,MARvC,EASThP,EAAIgI,KAAKQ,MAAMgB,iBAAiB,GAAK,EAT5B,EAWfxB,KAAKO,QAAQ0C,UAAY,2BACzBjD,KAAKwR,iBAAiB9Z,EAZP,EAYmBM,EAAI,GAAI6Z,EAAW7K,MAAQ,GAAI,IAEjEhH,KAAKO,QAAQ0C,UAAY,qBACzBjD,KAAKO,QAAQqR,SAAS5R,KAAKgB,QAAQ4G,YAAalQ,EAAGM,4CAGpCN,EAAGM,EAAGgP,EAAOC,GAAoB,IAAZ8K,EAAY1T,UAAAhG,OAAA,QAAA+D,IAAAiC,UAAA,GAAAA,UAAA,GAAH,EAC7C2B,KAAKO,QAAQqD,YACb5D,KAAKO,QAAQ4D,OAAOzM,EAAIqa,EAAQ/Z,GAChCgI,KAAKO,QAAQ6D,OAAO1M,EAAIsP,EAAQ+K,EAAQ/Z,GACxCgI,KAAKO,QAAQyR,iBAAiBta,EAAIsP,EAAOhP,EAAGN,EAAIsP,EAAOhP,EAAI+Z,GAC3D/R,KAAKO,QAAQ6D,OAAO1M,EAAIsP,EAAOhP,EAAIiP,EAAS8K,GAC5C/R,KAAKO,QAAQyR,iBAAiBta,EAAIsP,EAAOhP,EAAIiP,EAAQvP,EAAIsP,EAAQ+K,EAAQ/Z,EAAIiP,GAC7EjH,KAAKO,QAAQ6D,OAAO1M,EAAIqa,EAAQ/Z,EAAIiP,GACpCjH,KAAKO,QAAQyR,iBAAiBta,EAAGM,EAAIiP,EAAQvP,EAAGM,EAAIiP,EAAS8K,GAC7D/R,KAAKO,QAAQ6D,OAAO1M,EAAGM,EAAI+Z,GAC3B/R,KAAKO,QAAQyR,iBAAiBta,EAAGM,EAAGN,EAAIqa,EAAQ/Z,GAChDgI,KAAKO,QAAQ0R,YAEbjS,KAAKO,QAAQuD,0CAGJsD,GAAS,IAAA8K,EAAAlS,KAClBoH,EAAQhH,IAAI,SAAAqG,GAAM,OAAIyL,EAAKC,UAAU1L,uCAG7BA,GACRzG,KAAKQ,MAAMmK,eAAevD,QAAQnN,KAAKwM,GACvCzG,KAAKQ,MAAMuK,aAAc,EACzB/K,KAAKQ,MAAMwK,sBAAuB,qCAGzB5D,GACTpH,KAAKQ,MAAMmK,eAAevD,QAAUA,EACpCpH,KAAKQ,MAAMuK,aAAc,EACzB/K,KAAKQ,MAAMwK,sBAAuB,qCAGzBiF,GACTjQ,KAAKQ,MAAMoK,SAAS3Q,KAAKgW,uCAGfrF,GACV5K,KAAKQ,MAAMoK,SAAWA,iNCjrBLwH,aACnB,SAAAA,EAAYxL,GAAiC,IAAzB5F,EAAyB3C,UAAAhG,OAAA,QAAA+D,IAAAiC,UAAA,GAAAA,UAAA,GAAf,GAAI6S,EAAW7S,UAAAhG,OAAA,QAAA+D,IAAAiC,UAAA,GAAAA,UAAA,GAAJ,gGAAIgU,CAAArS,KAAAoS,GAC3CpS,KAAKsS,QAAU1L,EACf5G,KAAKuS,SAAWtc,OAAOoT,OAAO,GAAIhB,EAAsBrH,GACxDhB,KAAKwS,MAAQtB,wDA4DR3Q,EAASmG,EAAU+L,GACxB,IAAIC,EAAiB,KAErB,OAAQ1S,KAAKgB,QAAQuH,MACnB,IAAK,SACHmK,EAAiB1S,KAAK2S,aACtB,MAEF,IAAK,SACHD,EAAiB1S,KAAK4S,aACtB,MAEF,IAAK,QACHF,EAAiB1S,KAAK6S,YACtB,MAEF,IAAK,QACHH,EAAiB1S,KAAK8S,YAI1B,IAAKJ,EACH,MAAM,IAAItJ,MAAJ,6BAAA9M,OAAuC0D,KAAKgB,QAAQuH,KAApD,OAENmK,EAAiBA,EAAe3b,KAAKiJ,OACtBO,EAASmG,EAAU+L,wCAIzBlS,EAASmG,GACpBnG,EAAQ0C,UAAYjD,KAAKgB,QAAQsH,MACjC/H,EAAQmD,YAAc1D,KAAKgB,QAAQ0C,YACnCnD,EAAQoI,UAAY3I,KAAKgB,QAAQ2H,UAEjCpI,EAAQwS,OACRxS,EAAQqD,YACRrD,EAAQsD,IAAI6C,EAAS,GAAIA,EAAS,GAAI1G,KAAK+D,KAAK,GAAK,EAAG,EAAG,EAAI9L,KAAK0G,IACpE4B,EAAQuD,OAEJ9D,KAAKgB,QAAQ0H,cACfnI,EAAQ8D,SAGV9D,EAAQyS,8CAGEzS,EAASmG,GACnBnG,EAAQ0C,UAAYjD,KAAKgB,QAAQsH,MACjC/H,EAAQmD,YAAc1D,KAAKgB,QAAQsH,MAEnC/H,EAAQwS,OACRxS,EAAQqD,YACRrD,EAAQoI,UAAY,EACpBpI,EAAQsD,IAAI6C,EAAS,GAAIA,EAAS,GAAI1G,KAAK+D,KAAK,GAAK,EAAG,EAAG,EAAI9L,KAAK0G,IACpE4B,EAAQ8D,SACR9D,EAAQyS,+CAGGzS,EAASmG,EAAU+L,GAC9BzS,KAAKiT,aAAa1S,EAASmG,EAAU+L,GAErClS,EAAQ0C,UAAYjD,KAAKgB,QAAQsH,MACjC/H,EAAQmD,YAAc1D,KAAKgB,QAAQsH,MAEnC,IAAMvE,EAAO/D,KAAK+D,KAEZrM,EAAIgP,EAAS,GAAK3C,EAAK,GAAK,EAC5B/L,EAAI0O,EAAS,GAAK3C,EAAK,GAE7BxD,EAAQwS,OACRxS,EAAQ2S,UAAU,QAAU,EAAU,EAAU,QAAU,QAAWxb,EAAG,QAAWM,GACnFuI,EAAQqD,YACRrD,EAAQoI,UAAY,SACpBpI,EAAQ4D,OAAO,IAAY,WAC3B5D,EAAQ4S,cAAc,WAAY,WAAY,UAAW,SAAW,SAAU,WAC9E5S,EAAQ4S,eAAe,SAAU,UAAW,GAAW,UAAY,GAAW,WAC9E5S,EAAQ4S,cAAc,GAAW,UAAY,UAAW,UAAW,UAAW,WAC9E5S,EAAQ4S,cAAc,WAAY,QAAU,WAAY,UAAW,IAAY,WAC/E5S,EAAQ4D,OAAO,GAAW,WAC1B5D,EAAQ4S,cAAc,UAAW,UAAW,UAAW,UAAW,UAAW,WAC7E5S,EAAQ4S,cAAc,UAAW,UAAW,UAAW,SAAU,GAAW,UAC5E5S,EAAQ4S,cAAc,UAAW,SAAU,UAAW,UAAW,UAAW,WAC5E5S,EAAQ4S,cAAc,UAAW,UAAW,UAAW,UAAW,GAAW,WAC7E5S,EAAQuD,OACRvD,EAAQyS,8CAGEzS,EAASmG,EAAU+L,GAC7B,GAAIzS,KAAKgB,QAAQwH,MAAO,CACtBxI,KAAKiT,aAAa1S,EAASmG,EAAU+L,GAErC,IAAM1O,EAAO/D,KAAK+D,KACZrM,EAAIgP,EAAS,GAAK3C,EAAK,GAAK,EAAI/D,KAAK0H,OAAO,GAC5C1P,EAAI0O,EAAS,GAAK3C,EAAK,GAAK,EAAI/D,KAAK0H,OAAO,GAElDnH,EAAQ+C,UAAUtD,KAAKgB,QAAQwH,MAAO9Q,EAAGM,EAAG+L,EAAK,GAAIA,EAAK,0CAIjDxD,EAASmG,EAAU+L,GAC1BzS,KAAKgB,QAAQyH,cAAgBgK,EAAU,IACzClS,EAAQwS,OACRxS,EAAQ0C,UAAY1C,EAAQmD,YAAcnD,EAAQ6S,YAAc,qBAChE7S,EAAQ8S,WAAa,EAErB9S,EAAQqD,YACRrD,EAAQ+S,QAAQ5M,EAAS,GAAIA,EAAS,GAAK,EAAG,EAAG,IAAKzO,KAAK0G,GAAI,EAAG,EAAI1G,KAAK0G,IAC3E4B,EAAQuD,OACRvD,EAAQyS,0CApKV,OAAOhT,KAAKsS,wCAIZ,OAAOtS,KAAKuS,sCAIZ,OAAOvS,KAAKwS,mCAIZ,OAAQxS,KAAKgB,QAAQuH,MACnB,IAAK,SACH,MAAO,CACL,UACA,WAGJ,IAAK,SACH,IAAMgL,EAAevT,KAAKgB,QAAQ0H,aAC9B1I,KAAKgB,QAAQ2H,UACb,EAEJ,MAAO,CAAC,GAAK4K,EAAc,GAAKA,GAGlC,IAAK,QACH,MAAO,CAAC,GAAI,IAEd,IAAK,QACH,OAAOvT,KAAKgB,QAAQwH,MAChB,CAACxI,KAAKgB,QAAQwH,MAAMxB,MAAOhH,KAAKgB,QAAQwH,MAAMvB,QAC9C,KAEN,QACE,OAAO,qCAKX,OAAQjH,KAAKgB,QAAQuH,MACnB,IAAK,SACH,MAAO,CACL,GACEvI,KAAK+D,KAAK,GAAK,GAGrB,IAAK,QACH,OAAO/D,KAAKgB,QAAQ0G,QAAU,CAAC,EAAG,GAEpC,QACE,MAAO,CAAC,EAAG,yCC9DJ8L,EAAA,SAAA9b,GACf,OAAAA,GCCe+b,EAAA,SAAAP,GACf,SAAAA,EAAA,OAAgCM,EAChC,IAAA3a,EACAM,EACAua,EAAAR,EAAAvV,MAAA,GACAgW,EAAAT,EAAAvV,MAAA,GACAiW,EAAAV,EAAAW,UAAA,GACAC,EAAAZ,EAAAW,UAAA,GACA,gBAAAE,EAAAxe,GACAA,IAAAsD,EAAAM,EAAA,GACA,IAAAX,EAAA,EAAAxB,EAAA+c,EAAA1b,OAAA2b,EAAA,IAAAra,MAAA3C,GAGA,IAFAgd,EAAA,IAAAnb,GAAAkb,EAAA,IAAAL,EAAAE,EACAI,EAAA,IAAA7a,GAAA4a,EAAA,IAAAJ,EAAAG,EACAtb,EAAAxB,GAAAgd,EAAAxb,GAAAub,EAAAvb,OACA,OAAAwb,IChBeC,EAAA,SAAAC,EAAAld,GAEf,IADA,IAAAP,EAAA+B,EAAA0b,EAAA7b,OAAA9C,EAAAiD,EAAAxB,EACAzB,IAAAiD,GAAA/B,EAAAyd,EAAA3e,GAAA2e,EAAA3e,KAAA2e,EAAA1b,GAAA0b,EAAA1b,GAAA/B,GCCe0d,EAAA,SAAAC,EAAApe,GACf,6BAAAA,EAAAuS,KACA,CAASA,KAAA,oBAAA8L,SAAAre,EAAAse,WAAAlU,IAAA,SAAApK,GAAmE,OAAQue,EAAOH,EAAApe,MACnFue,EAAOH,EAAApe,IAGR,SAASue,EAAOH,EAAApe,GACvB,IAAAiM,EAAAjM,EAAAiM,GACAuS,EAAAxe,EAAAwe,KACAC,EAAA,MAAAze,EAAAye,WAAA,GAA4Cze,EAAAye,WAC5CC,EAAiBC,EAAMP,EAAApe,GACvB,aAAAiM,GAAA,MAAAuS,EAAA,CAAuCjM,KAAA,UAAAkM,aAAAC,YACvC,MAAAF,EAAA,CAAwBjM,KAAA,UAAAtG,KAAAwS,aAAAC,YACxB,CAASnM,KAAA,UAAAtG,KAAAuS,OAAAC,aAAAC,YAGF,SAASC,EAAMP,EAAApe,GACtB,IAAA4e,EAAuBnB,EAASW,EAAAlB,WAChC2B,EAAAT,EAAAS,KAEA,SAAAhR,EAAAtO,EAAAuf,GACAA,EAAAzc,QAAAyc,EAAAC,MACA,QAAAxd,EAAAsd,EAAAtf,EAAA,GAAAA,KAAA0D,EAAA,EAAAjC,EAAAO,EAAAc,OAA2DY,EAAAjC,IAAOiC,EAClE6b,EAAA7a,KAAA2a,EAAArd,EAAA0B,OAEA1D,EAAA,GAAe0e,EAAOa,EAAA9d,GAGtB,SAAAoB,EAAAf,GACA,OAAAud,EAAAvd,GAGA,SAAA2d,EAAAH,GAEA,IADA,IAAAC,EAAA,GACAvf,EAAA,EAAAyB,EAAA6d,EAAAxc,OAAoC9C,EAAAyB,IAAOzB,EAAAsO,EAAAgR,EAAAtf,GAAAuf,GAE3C,OADAA,EAAAzc,OAAA,GAAAyc,EAAA7a,KAAA6a,EAAA,IACAA,EAGA,SAAAG,EAAAJ,GAEA,IADA,IAAAC,EAAAE,EAAAH,GACAC,EAAAzc,OAAA,GAAAyc,EAAA7a,KAAA6a,EAAA,IACA,OAAAA,EAGA,SAAA7E,EAAA4E,GACA,OAAAA,EAAAzU,IAAA6U,GAkBA,OAfA,SAAAP,EAAA1e,GACA,IAAAkf,EAAA3M,EAAAvS,EAAAuS,KACA,OAAAA,GACA,gCAAyCA,OAAA+L,WAAAte,EAAAse,WAAAlU,IAAAsU,IACzC,YAAAQ,EAAA9c,EAAApC,EAAAkf,aAAuD,MACvD,iBAAAA,EAAAlf,EAAAkf,YAAA9U,IAAAhI,GAAgE,MAChE,iBAAA8c,EAAAF,EAAAhf,EAAA6e,MAAoD,MACpD,sBAAAK,EAAAlf,EAAA6e,KAAAzU,IAAA4U,GAA6D,MAC7D,cAAAE,EAAAjF,EAAAja,EAAA6e,MAAoD,MACpD,mBAAAK,EAAAlf,EAAA6e,KAAAzU,IAAA6P,GAA6D,MAC7D,oBAEA,OAAY1H,OAAA2M,eAGZR,CAAA1e,GCnEe,sTCKMmf,aACnB,SAAAA,EAAYC,EAAMC,GAA0D,IAA9CrU,EAA8C3C,UAAAhG,OAAA,QAAA+D,IAAAiC,UAAA,GAAAA,UAAA,GAApC,GAAIiX,EAAgCjX,UAAAhG,OAAA,QAAA+D,IAAAiC,UAAA,GAAAA,UAAA,GAAjB,KAAM6S,EAAW7S,UAAAhG,OAAA,QAAA+D,IAAAiC,UAAA,GAAAA,UAAA,GAAJ,GAUtE,+FAV0EkX,CAAAvV,KAAAmV,GAC1EnV,KAAKuS,SAAWtc,OAAOoT,OAAO,GAAIT,EAAuB5H,GACzDhB,KAAKwV,cAAgBvf,OAAOoT,OAAO,GAAIT,EAAuBI,EAA4BsM,GAC1FtV,KAAKwS,MAAQtB,EACblR,KAAKyV,YAAczV,KAAK0V,0BAEnBL,IACHA,EAAapf,OAAO0f,KAAKP,EAAKQ,SAAS,MAGnCP,KAAcD,EAAKQ,SACvB,MAAM,IAAIxM,MAAJ,2CAAA9M,OAAqDrG,OAAO0f,KAAKP,EAAKQ,SAAS9b,KAAK,QAG5FkG,KAAK0U,SAAWP,EAAQiB,EAAMA,EAAKQ,QAAQP,6EAgCrC,0BAA2BlgB,SAC/BA,OAAO0gB,sBAAwB,IAGjC,IAAMC,EAAQ3gB,OAAO0gB,sBAAsBxd,OAO3C,OALAlD,OAAO0gB,sBAAsBC,GAAS,CACpCpB,SAAU,KACVqB,kBAAmB,MAGdD,0CAGOvV,EAASmF,EAAUoF,GAAe,IAAA9I,EAAAhC,KAC1CgW,EAAmB/d,KAAKmJ,MAAMsE,EAASvH,QAAUuH,EAASvH,KAEhE,IAAK6B,KAAKgB,QAAQ+H,cAAgB/I,KAAK0U,WAAa1U,KAAK+V,mBAAqBC,GACtElL,EAAcpT,EAAI,GAAKoT,EAAc9S,EAAI,EAC/C,MAAO,GAGT,IAAM2N,EAAa3F,KAAK8F,oBAAoBJ,GACtC1C,EAAehD,KAAKiW,sBAAsBvQ,EAAUC,GACpDvN,EAAQ,CACZ0S,EAAcpT,EAAIsL,EAAa,GAAK0C,EAASf,aAAa,GAC1DmG,EAAc9S,EAAIgL,EAAa,GAAK0C,EAASf,aAAa,IAG5D,OAAO3E,KAAK+V,kBAAkB1O,OAAO,SAAAmJ,GACnC,IAAM0F,EAAU1F,EAAKkE,SAASrN,OAAO,SAAA8O,GAAI,OAAoC,IAAhCC,IAAcD,EAAM/d,KAAeC,OAAS,EA0BzF,OAxBI6d,GAAW3V,IACbA,EAAQqD,YAER4M,EAAKkE,SAAStU,IAAI,SAAC+V,GACjBA,EAAK/V,IAAI,SAACsG,EAAUoP,GAClBpP,EAAW,CACTA,EAAS,GAAK1D,EAAa,GAAK0C,EAASf,aAAa,GACtD+B,EAAS,GAAK1D,EAAa,GAAK0C,EAASf,aAAa,IAG1C,IAAVmR,EACFvV,EAAQ4D,OAAOuC,EAAS,GAAIA,EAAS,IAErCnG,EAAQ6D,OAAOsC,EAAS,GAAIA,EAAS,QAK3C1E,EAAKqU,mBAAmB9V,EAASyB,EAAKsT,aAAc5P,EAASvH,MAEzD6D,EAAKhB,QAAQ0H,cAAcnI,EAAQuD,OACnC9B,EAAKhB,QAAQ8H,YAAYvI,EAAQ8D,UAGhC6R,kDAIWxQ,EAAUC,GAC9B,MAAO,EACH1H,EAAeuB,SAASkG,EAAStG,OAAO,GAAIuG,GAAY,GAASD,EAASrG,UAC1EpB,EAAeyB,SAASgG,EAAStG,OAAO,GAAIuG,GAAY,GAASD,EAASrG,iDAIjEqG,EAAUK,GACvB,IAAMK,EAAmBpG,KAAKwF,oBAAsBE,EAAStG,OAC3DiH,EAA+B,IAAbN,GAAkB/F,KAAKyF,oBAAsBC,EAASvH,KAE1E,OAAOiI,GAAoBC,iCAGtB9F,EAASmF,GAAU,IAAA4I,EAAAtO,KACxB,GAAKA,KAAK0U,SAAV,CAIA,IAAM/O,EAAa3F,KAAK8F,oBAAoBJ,GAEtCK,EAAWJ,EACbD,EAASvH,KAAOwH,EAChB,EAEEhI,EAAqB,IAAboI,EACV9N,KAAKC,IAAI,EAAG6N,GACZ,EAEJ,GAAI/F,KAAKgG,eAAeN,EAAUK,GAAW,CAC3C,IAAI/C,EAEJhD,KAAKyF,kBAAoBC,EAASvH,KAClC6B,KAAKwF,kBAAoBE,EAAStG,OAElCY,KAAK+V,kBAAoB/V,KAAK0U,SAASL,SAASjU,IAAI,SAAA+T,GAClD,yUAAAmC,CAAA,GACKnC,EADL,CAEEO,SAAUpG,EAAKiI,gBAAgBpC,EAAQO,SAAUhP,OAIrD1C,EAAehD,KAAKiW,sBAAsBvQ,EAAUC,GAEpD3F,KAAKwW,wBAAwBxT,GAE7B,IAAMyT,EAAgB,CACpB/Q,EAASf,aAAa,GAAKe,EAASrC,WAAW,GAAMrD,KAAK0W,eAAeC,KAAOhZ,EAChF+H,EAASf,aAAa,GAAKe,EAASrC,WAAW,GAAMrD,KAAK0W,eAAeE,KAAOjZ,GAG5EkZ,EAAY,CAChBtJ,KAAMtV,KAAKsG,OAA0B,EAApBkY,EAAc,IAC/BK,MAAO7e,KAAK8I,KAAK9I,KAAKiE,IAAIua,EAAc,IAAM/Q,EAASlE,iBAAiB,IACxEiM,IAAKxV,KAAKsG,OAA0B,EAApBkY,EAAc,IAC9BM,OAAQ9e,KAAK8I,KAAK9I,KAAKiE,IAAIua,EAAc,IAAM/Q,EAASlE,iBAAiB,KAG3ExB,KAAKgX,sBAAsBtR,EAAU1C,EAAc6T,GAGrD,IAAMI,EAAoB,CACxBvR,EAASrC,WAAW,GAAMqC,EAASf,aAAa,IAAMhH,EAAQ,GAC9D+H,EAASrC,WAAW,GAAMqC,EAASf,aAAa,IAAMhH,EAAQ,IAG1DuZ,EAAclX,KAAKmX,kBAAkB,GAAKxZ,EAC9CyZ,EAAepX,KAAKmX,kBAAkB,GAAKxZ,EAE7C4C,EAAQ+C,UACNtD,KAAKuF,gBACL0R,EAAkB,GAAIA,EAAkB,GACxCC,EAAaE,gDAIG1R,GAClB,IAAIC,EAAaD,EAASvH,KAQ1B,OANIuH,EAAShB,WAAagB,EAASvH,KACjCwH,EAAa1N,KAAKsG,MAAMmH,EAASvH,MACxBuH,EAAShB,WAAagB,EAASvH,OACxCwH,EAAa1N,KAAK8I,KAAK2E,EAASvH,OAG3BwH,gDAGa0R,GAUpB,OATArX,KAAKmX,kBAAoB,CACvBE,EAASP,MAAQO,EAAS9J,KAC1B8J,EAASN,OAASM,EAAS5J,KAG7BzN,KAAKuF,gBAAkBuB,SAASC,cAAc,UAC9C/G,KAAKuF,gBAAgByB,MAAQhH,KAAKmX,kBAAkB,GACpDnX,KAAKuF,gBAAgB0B,OAASjH,KAAKmX,kBAAkB,GAE9CnX,KAAKuF,gBAAgB2B,WAAW,sDAGjBlE,GACtB,IAAI2T,EAAMW,EAAMV,EAAMW,EAAO,KAE7BvX,KAAKwX,YAAY,SAAA9Q,GACfA,EAAW,CACTA,EAAS,GAAK1D,EAAa,GAC3B0D,EAAS,GAAK1D,EAAa,MAGxBsU,GAAQ5Q,EAAS,GAAK4Q,KACzBA,EAAO5Q,EAAS,MAGbiQ,GAAQjQ,EAAS,GAAKiQ,KACzBA,EAAOjQ,EAAS,MAGb6Q,GAAQ7Q,EAAS,GAAK6Q,KACzBA,EAAO7Q,EAAS,MAGbkQ,GAAQlQ,EAAS,GAAKkQ,KACzBA,EAAOlQ,EAAS,MAIpB1G,KAAKmX,kBAAoB,CACvBlf,KAAK8I,KAAKuW,EAAOX,GACjB1e,KAAK8I,KAAKwW,EAAOX,IAGnB5W,KAAK0W,eAAiB,CACpBC,OAAMW,OACNV,OAAMW,sDAIY7R,EAAU1C,EAAcqU,GAAU,IAAArH,EAAAhQ,KAChDyX,EAAmBzX,KAAKsG,sBAAsB+Q,GAEpDI,EAAiB7T,YACjB6T,EAAiBhG,KAAO,qBAExBzR,KAAK+V,kBAAkB3V,IAAI,SAACoQ,GAAD,OACzBA,EAAKkE,SAAStU,IAAI,SAAC+V,GACQA,EAAK9O,OAAO,SAAAX,GAMnC,OALAA,EAAW,CACTA,EAAS,GAAKsJ,EAAK0G,eAAeC,KAAO3T,EAAa,GACtD0D,EAAS,GAAKsJ,EAAK0G,eAAeE,KAAO5T,EAAa,KAGxC,IAAMqU,EAAS9J,MAAQ7G,EAAS,IAAM2Q,EAASP,OAC3DpQ,EAAS,IAAM2Q,EAAS5J,KAAO/G,EAAS,IAAM2Q,EAASN,SAGxC1e,OAAS,GAC5B8d,EAAK/V,IAAI,SAACsG,EAAUoP,GAClBpP,EAAW,CACTA,EAAS,GAAKsJ,EAAK0G,eAAeC,KAAO3T,EAAa,GAAKqU,EAAS9J,KACpE7G,EAAS,GAAKsJ,EAAK0G,eAAeE,KAAO5T,EAAa,GAAKqU,EAAS5J,KAGxD,IAAVqI,EAGF2B,EAAiBtT,OAAOuC,EAAS,GAAIA,EAAS,IAE9C+Q,EAAiBrT,OAAOsC,EAAS,GAAIA,EAAS,UAOxD1G,KAAKqW,mBAAmBoB,EAAkBzX,KAAKgB,QAAS0E,EAASvH,MAE7D6B,KAAKgB,QAAQ0H,cAAc+O,EAAiB3T,OAC5C9D,KAAKgB,QAAQ8H,YAAY2O,EAAiBpT,oDAG7B9D,EAASS,EAAS7C,GACnCoC,EAAQ0C,UAAYjC,EAAQiC,UAC5B1C,EAAQmD,YAAc1C,EAAQ0C,YAC9BnD,EAAQoI,UAAY3H,EAAQ2H,UAAYxK,EACxCoC,EAAQmX,YAAY1W,EAAQ6H,UAC5BtI,EAAQoX,SAAW,4CAGTC,GACV,OAAO5X,KAAK+V,kBAAkB3V,IAAI,SAACoQ,GAAD,OAChCA,EAAKkE,SAAStU,IAAI,SAAC+V,GAAD,OAChBA,EAAK/V,IAAIwX,+CAKClD,EAAUhP,GAAU,IAAA2K,EAAArQ,KAClC,GAAI0U,EACF,OAAQA,EAASnM,MACf,IAAK,UACH,MAAO,CAACmM,EAASQ,YAAY,GAAG9U,IAAI,SAAAoQ,GAAI,OAAIH,EAAKwH,aAAanS,EAAU8K,EAAK,GAAIA,EAAK,OAExF,IAAK,eACH,OAAOkE,EAASQ,YAAY9U,IAAI,SAAA8U,GAAW,OACzCA,EAAY,GAAG9U,IAAI,SAAAoQ,GAAI,OAAIH,EAAKwH,aAAanS,EAAU8K,EAAK,GAAIA,EAAK,QAK7E,MAAO,wCAGI9K,EAAUhO,EAAGM,GACxB,IAAM0O,EAAWzI,EAAe0I,cAC9B,CAAC3O,EAAGN,GACJ,KACAgO,EAASvH,KACTuH,EAASrG,UAGX,MAAO,EAAEqH,EAAS,IAAKA,EAAS,oCArThC,OAAO1G,KAAKuS,8CAIZ,OAAOvS,KAAKwV,2CAIZ,OAAOxV,KAAKwS,uCAIZ,OAAOrd,OAAO0gB,sBAAsB7V,KAAKyV,aAAaf,uBAG3CA,GACXvf,OAAO0gB,sBAAsB7V,KAAKyV,aAAaf,SAAWA,4CAI1D,OAAOvf,OAAO0gB,sBAAsB7V,KAAKyV,aAAaM,gCAGlCA,GACpB5gB,OAAO0gB,sBAAsB7V,KAAKyV,aAAaM,kBAAoBA,uCChDvE1gB,EAAAQ,EAAAiiB,EAAA,wBAAAC,IAAA1iB,EAAAQ,EAAAiiB,EAAA,2BAAAE,IAAA3iB,EAAAQ,EAAAiiB,EAAA,4BAAAG","file":"LightningMaps.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"LightningMaps\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"LightningMaps\"] = factory();\n\telse\n\t\troot[\"LightningMaps\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 7);\n","\"use strict\"\n\nmodule.exports = twoProduct\n\nvar SPLITTER = +(Math.pow(2, 27) + 1.0)\n\nfunction twoProduct(a, b, result) {\n  var x = a * b\n\n  var c = SPLITTER * a\n  var abig = c - a\n  var ahi = c - abig\n  var alo = a - ahi\n\n  var d = SPLITTER * b\n  var bbig = d - b\n  var bhi = d - bbig\n  var blo = b - bhi\n\n  var err1 = x - (ahi * bhi)\n  var err2 = err1 - (alo * bhi)\n  var err3 = err2 - (ahi * blo)\n\n  var y = alo * blo - err3\n\n  if(result) {\n    result[0] = y\n    result[1] = x\n    return result\n  }\n\n  return [ y, x ]\n}","module.exports = robustPointInPolygon\n\nvar orient = require('robust-orientation')\n\nfunction robustPointInPolygon(vs, point) {\n  var x = point[0]\n  var y = point[1]\n  var n = vs.length\n  var inside = 1\n  var lim = n\n  for(var i = 0, j = n-1; i<lim; j=i++) {\n    var a = vs[i]\n    var b = vs[j]\n    var yi = a[1]\n    var yj = b[1]\n    if(yj < yi) {\n      if(yj < y && y < yi) {\n        var s = orient(a, b, point)\n        if(s === 0) {\n          return 0\n        } else {\n          inside ^= (0 < s)|0\n        }\n      } else if(y === yi) {\n        var c = vs[(i+1)%n]\n        var yk = c[1]\n        if(yi < yk) {\n          var s = orient(a, b, point)\n          if(s === 0) {\n            return 0\n          } else {\n            inside ^= (0 < s)|0\n          }\n        }\n      }\n    } else if(yi < yj) {\n      if(yi < y && y < yj) {\n        var s = orient(a, b, point)\n        if(s === 0) {\n          return 0\n        } else {\n          inside ^= (s < 0)|0\n        }\n      } else if(y === yi) {\n        var c = vs[(i+1)%n]\n        var yk = c[1]\n        if(yk < yi) {\n          var s = orient(a, b, point)\n          if(s === 0) {\n            return 0\n          } else {\n            inside ^= (s < 0)|0\n          }\n        }\n      }\n    } else if(y === yi) {\n      var x0 = Math.min(a[0], b[0])\n      var x1 = Math.max(a[0], b[0])\n      if(i === 0) {\n        while(j>0) {\n          var k = (j+n-1)%n\n          var p = vs[k]\n          if(p[1] !== y) {\n            break\n          }\n          var px = p[0]\n          x0 = Math.min(x0, px)\n          x1 = Math.max(x1, px)\n          j = k\n        }\n        if(j === 0) {\n          if(x0 <= x && x <= x1) {\n            return 0\n          }\n          return 1 \n        }\n        lim = j+1\n      }\n      var y0 = vs[(j+n-1)%n][1]\n      while(i+1<lim) {\n        var p = vs[i+1]\n        if(p[1] !== y) {\n          break\n        }\n        var px = p[0]\n        x0 = Math.min(x0, px)\n        x1 = Math.max(x1, px)\n        i += 1\n      }\n      if(x0 <= x && x <= x1) {\n        return 0\n      }\n      var y1 = vs[(i+1)%n][1]\n      if(x < x0 && (y0 < y !== y1 < y)) {\n        inside ^= 1\n      }\n    }\n  }\n  return 2 * inside - 1\n}","\"use strict\"\n\nvar twoProduct = require(\"two-product\")\nvar robustSum = require(\"robust-sum\")\nvar robustScale = require(\"robust-scale\")\nvar robustSubtract = require(\"robust-subtract\")\n\nvar NUM_EXPAND = 5\n\nvar EPSILON     = 1.1102230246251565e-16\nvar ERRBOUND3   = (3.0 + 16.0 * EPSILON) * EPSILON\nvar ERRBOUND4   = (7.0 + 56.0 * EPSILON) * EPSILON\n\nfunction cofactor(m, c) {\n  var result = new Array(m.length-1)\n  for(var i=1; i<m.length; ++i) {\n    var r = result[i-1] = new Array(m.length-1)\n    for(var j=0,k=0; j<m.length; ++j) {\n      if(j === c) {\n        continue\n      }\n      r[k++] = m[i][j]\n    }\n  }\n  return result\n}\n\nfunction matrix(n) {\n  var result = new Array(n)\n  for(var i=0; i<n; ++i) {\n    result[i] = new Array(n)\n    for(var j=0; j<n; ++j) {\n      result[i][j] = [\"m\", j, \"[\", (n-i-1), \"]\"].join(\"\")\n    }\n  }\n  return result\n}\n\nfunction sign(n) {\n  if(n & 1) {\n    return \"-\"\n  }\n  return \"\"\n}\n\nfunction generateSum(expr) {\n  if(expr.length === 1) {\n    return expr[0]\n  } else if(expr.length === 2) {\n    return [\"sum(\", expr[0], \",\", expr[1], \")\"].join(\"\")\n  } else {\n    var m = expr.length>>1\n    return [\"sum(\", generateSum(expr.slice(0, m)), \",\", generateSum(expr.slice(m)), \")\"].join(\"\")\n  }\n}\n\nfunction determinant(m) {\n  if(m.length === 2) {\n    return [[\"sum(prod(\", m[0][0], \",\", m[1][1], \"),prod(-\", m[0][1], \",\", m[1][0], \"))\"].join(\"\")]\n  } else {\n    var expr = []\n    for(var i=0; i<m.length; ++i) {\n      expr.push([\"scale(\", generateSum(determinant(cofactor(m, i))), \",\", sign(i), m[0][i], \")\"].join(\"\"))\n    }\n    return expr\n  }\n}\n\nfunction orientation(n) {\n  var pos = []\n  var neg = []\n  var m = matrix(n)\n  var args = []\n  for(var i=0; i<n; ++i) {\n    if((i&1)===0) {\n      pos.push.apply(pos, determinant(cofactor(m, i)))\n    } else {\n      neg.push.apply(neg, determinant(cofactor(m, i)))\n    }\n    args.push(\"m\" + i)\n  }\n  var posExpr = generateSum(pos)\n  var negExpr = generateSum(neg)\n  var funcName = \"orientation\" + n + \"Exact\"\n  var code = [\"function \", funcName, \"(\", args.join(), \"){var p=\", posExpr, \",n=\", negExpr, \",d=sub(p,n);\\\nreturn d[d.length-1];};return \", funcName].join(\"\")\n  var proc = new Function(\"sum\", \"prod\", \"scale\", \"sub\", code)\n  return proc(robustSum, twoProduct, robustScale, robustSubtract)\n}\n\nvar orientation3Exact = orientation(3)\nvar orientation4Exact = orientation(4)\n\nvar CACHED = [\n  function orientation0() { return 0 },\n  function orientation1() { return 0 },\n  function orientation2(a, b) { \n    return b[0] - a[0]\n  },\n  function orientation3(a, b, c) {\n    var l = (a[1] - c[1]) * (b[0] - c[0])\n    var r = (a[0] - c[0]) * (b[1] - c[1])\n    var det = l - r\n    var s\n    if(l > 0) {\n      if(r <= 0) {\n        return det\n      } else {\n        s = l + r\n      }\n    } else if(l < 0) {\n      if(r >= 0) {\n        return det\n      } else {\n        s = -(l + r)\n      }\n    } else {\n      return det\n    }\n    var tol = ERRBOUND3 * s\n    if(det >= tol || det <= -tol) {\n      return det\n    }\n    return orientation3Exact(a, b, c)\n  },\n  function orientation4(a,b,c,d) {\n    var adx = a[0] - d[0]\n    var bdx = b[0] - d[0]\n    var cdx = c[0] - d[0]\n    var ady = a[1] - d[1]\n    var bdy = b[1] - d[1]\n    var cdy = c[1] - d[1]\n    var adz = a[2] - d[2]\n    var bdz = b[2] - d[2]\n    var cdz = c[2] - d[2]\n    var bdxcdy = bdx * cdy\n    var cdxbdy = cdx * bdy\n    var cdxady = cdx * ady\n    var adxcdy = adx * cdy\n    var adxbdy = adx * bdy\n    var bdxady = bdx * ady\n    var det = adz * (bdxcdy - cdxbdy) \n            + bdz * (cdxady - adxcdy)\n            + cdz * (adxbdy - bdxady)\n    var permanent = (Math.abs(bdxcdy) + Math.abs(cdxbdy)) * Math.abs(adz)\n                  + (Math.abs(cdxady) + Math.abs(adxcdy)) * Math.abs(bdz)\n                  + (Math.abs(adxbdy) + Math.abs(bdxady)) * Math.abs(cdz)\n    var tol = ERRBOUND4 * permanent\n    if ((det > tol) || (-det > tol)) {\n      return det\n    }\n    return orientation4Exact(a,b,c,d)\n  }\n]\n\nfunction slowOrient(args) {\n  var proc = CACHED[args.length]\n  if(!proc) {\n    proc = CACHED[args.length] = orientation(args.length)\n  }\n  return proc.apply(undefined, args)\n}\n\nfunction generateOrientationProc() {\n  while(CACHED.length <= NUM_EXPAND) {\n    CACHED.push(orientation(CACHED.length))\n  }\n  var args = []\n  var procArgs = [\"slow\"]\n  for(var i=0; i<=NUM_EXPAND; ++i) {\n    args.push(\"a\" + i)\n    procArgs.push(\"o\" + i)\n  }\n  var code = [\n    \"function getOrientation(\", args.join(), \"){switch(arguments.length){case 0:case 1:return 0;\"\n  ]\n  for(var i=2; i<=NUM_EXPAND; ++i) {\n    code.push(\"case \", i, \":return o\", i, \"(\", args.slice(0, i).join(), \");\")\n  }\n  code.push(\"}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation\")\n  procArgs.push(code.join(\"\"))\n\n  var proc = Function.apply(undefined, procArgs)\n  module.exports = proc.apply(undefined, [slowOrient].concat(CACHED))\n  for(var i=0; i<=NUM_EXPAND; ++i) {\n    module.exports[i] = CACHED[i]\n  }\n}\n\ngenerateOrientationProc()","\"use strict\"\n\nmodule.exports = linearExpansionSum\n\n//Easy case: Add two scalars\nfunction scalarScalar(a, b) {\n  var x = a + b\n  var bv = x - a\n  var av = x - bv\n  var br = b - bv\n  var ar = a - av\n  var y = ar + br\n  if(y) {\n    return [y, x]\n  }\n  return [x]\n}\n\nfunction linearExpansionSum(e, f) {\n  var ne = e.length|0\n  var nf = f.length|0\n  if(ne === 1 && nf === 1) {\n    return scalarScalar(e[0], f[0])\n  }\n  var n = ne + nf\n  var g = new Array(n)\n  var count = 0\n  var eptr = 0\n  var fptr = 0\n  var abs = Math.abs\n  var ei = e[eptr]\n  var ea = abs(ei)\n  var fi = f[fptr]\n  var fa = abs(fi)\n  var a, b\n  if(ea < fa) {\n    b = ei\n    eptr += 1\n    if(eptr < ne) {\n      ei = e[eptr]\n      ea = abs(ei)\n    }\n  } else {\n    b = fi\n    fptr += 1\n    if(fptr < nf) {\n      fi = f[fptr]\n      fa = abs(fi)\n    }\n  }\n  if((eptr < ne && ea < fa) || (fptr >= nf)) {\n    a = ei\n    eptr += 1\n    if(eptr < ne) {\n      ei = e[eptr]\n      ea = abs(ei)\n    }\n  } else {\n    a = fi\n    fptr += 1\n    if(fptr < nf) {\n      fi = f[fptr]\n      fa = abs(fi)\n    }\n  }\n  var x = a + b\n  var bv = x - a\n  var y = b - bv\n  var q0 = y\n  var q1 = x\n  var _x, _bv, _av, _br, _ar\n  while(eptr < ne && fptr < nf) {\n    if(ea < fa) {\n      a = ei\n      eptr += 1\n      if(eptr < ne) {\n        ei = e[eptr]\n        ea = abs(ei)\n      }\n    } else {\n      a = fi\n      fptr += 1\n      if(fptr < nf) {\n        fi = f[fptr]\n        fa = abs(fi)\n      }\n    }\n    b = q0\n    x = a + b\n    bv = x - a\n    y = b - bv\n    if(y) {\n      g[count++] = y\n    }\n    _x = q1 + x\n    _bv = _x - q1\n    _av = _x - _bv\n    _br = x - _bv\n    _ar = q1 - _av\n    q0 = _ar + _br\n    q1 = _x\n  }\n  while(eptr < ne) {\n    a = ei\n    b = q0\n    x = a + b\n    bv = x - a\n    y = b - bv\n    if(y) {\n      g[count++] = y\n    }\n    _x = q1 + x\n    _bv = _x - q1\n    _av = _x - _bv\n    _br = x - _bv\n    _ar = q1 - _av\n    q0 = _ar + _br\n    q1 = _x\n    eptr += 1\n    if(eptr < ne) {\n      ei = e[eptr]\n    }\n  }\n  while(fptr < nf) {\n    a = fi\n    b = q0\n    x = a + b\n    bv = x - a\n    y = b - bv\n    if(y) {\n      g[count++] = y\n    } \n    _x = q1 + x\n    _bv = _x - q1\n    _av = _x - _bv\n    _br = x - _bv\n    _ar = q1 - _av\n    q0 = _ar + _br\n    q1 = _x\n    fptr += 1\n    if(fptr < nf) {\n      fi = f[fptr]\n    }\n  }\n  if(q0) {\n    g[count++] = q0\n  }\n  if(q1) {\n    g[count++] = q1\n  }\n  if(!count) {\n    g[count++] = 0.0  \n  }\n  g.length = count\n  return g\n}","\"use strict\"\n\nvar twoProduct = require(\"two-product\")\nvar twoSum = require(\"two-sum\")\n\nmodule.exports = scaleLinearExpansion\n\nfunction scaleLinearExpansion(e, scale) {\n  var n = e.length\n  if(n === 1) {\n    var ts = twoProduct(e[0], scale)\n    if(ts[0]) {\n      return ts\n    }\n    return [ ts[1] ]\n  }\n  var g = new Array(2 * n)\n  var q = [0.1, 0.1]\n  var t = [0.1, 0.1]\n  var count = 0\n  twoProduct(e[0], scale, q)\n  if(q[0]) {\n    g[count++] = q[0]\n  }\n  for(var i=1; i<n; ++i) {\n    twoProduct(e[i], scale, t)\n    var pq = q[1]\n    twoSum(pq, t[0], q)\n    if(q[0]) {\n      g[count++] = q[0]\n    }\n    var a = t[1]\n    var b = q[1]\n    var x = a + b\n    var bv = x - a\n    var y = b - bv\n    q[1] = x\n    if(y) {\n      g[count++] = y\n    }\n  }\n  if(q[1]) {\n    g[count++] = q[1]\n  }\n  if(count === 0) {\n    g[count++] = 0.0\n  }\n  g.length = count\n  return g\n}","\"use strict\"\n\nmodule.exports = fastTwoSum\n\nfunction fastTwoSum(a, b, result) {\n\tvar x = a + b\n\tvar bv = x - a\n\tvar av = x - bv\n\tvar br = b - bv\n\tvar ar = a - av\n\tif(result) {\n\t\tresult[0] = ar + br\n\t\tresult[1] = x\n\t\treturn result\n\t}\n\treturn [ar+br, x]\n}","\"use strict\"\n\nmodule.exports = robustSubtract\n\n//Easy case: Add two scalars\nfunction scalarScalar(a, b) {\n  var x = a + b\n  var bv = x - a\n  var av = x - bv\n  var br = b - bv\n  var ar = a - av\n  var y = ar + br\n  if(y) {\n    return [y, x]\n  }\n  return [x]\n}\n\nfunction robustSubtract(e, f) {\n  var ne = e.length|0\n  var nf = f.length|0\n  if(ne === 1 && nf === 1) {\n    return scalarScalar(e[0], -f[0])\n  }\n  var n = ne + nf\n  var g = new Array(n)\n  var count = 0\n  var eptr = 0\n  var fptr = 0\n  var abs = Math.abs\n  var ei = e[eptr]\n  var ea = abs(ei)\n  var fi = -f[fptr]\n  var fa = abs(fi)\n  var a, b\n  if(ea < fa) {\n    b = ei\n    eptr += 1\n    if(eptr < ne) {\n      ei = e[eptr]\n      ea = abs(ei)\n    }\n  } else {\n    b = fi\n    fptr += 1\n    if(fptr < nf) {\n      fi = -f[fptr]\n      fa = abs(fi)\n    }\n  }\n  if((eptr < ne && ea < fa) || (fptr >= nf)) {\n    a = ei\n    eptr += 1\n    if(eptr < ne) {\n      ei = e[eptr]\n      ea = abs(ei)\n    }\n  } else {\n    a = fi\n    fptr += 1\n    if(fptr < nf) {\n      fi = -f[fptr]\n      fa = abs(fi)\n    }\n  }\n  var x = a + b\n  var bv = x - a\n  var y = b - bv\n  var q0 = y\n  var q1 = x\n  var _x, _bv, _av, _br, _ar\n  while(eptr < ne && fptr < nf) {\n    if(ea < fa) {\n      a = ei\n      eptr += 1\n      if(eptr < ne) {\n        ei = e[eptr]\n        ea = abs(ei)\n      }\n    } else {\n      a = fi\n      fptr += 1\n      if(fptr < nf) {\n        fi = -f[fptr]\n        fa = abs(fi)\n      }\n    }\n    b = q0\n    x = a + b\n    bv = x - a\n    y = b - bv\n    if(y) {\n      g[count++] = y\n    }\n    _x = q1 + x\n    _bv = _x - q1\n    _av = _x - _bv\n    _br = x - _bv\n    _ar = q1 - _av\n    q0 = _ar + _br\n    q1 = _x\n  }\n  while(eptr < ne) {\n    a = ei\n    b = q0\n    x = a + b\n    bv = x - a\n    y = b - bv\n    if(y) {\n      g[count++] = y\n    }\n    _x = q1 + x\n    _bv = _x - q1\n    _av = _x - _bv\n    _br = x - _bv\n    _ar = q1 - _av\n    q0 = _ar + _br\n    q1 = _x\n    eptr += 1\n    if(eptr < ne) {\n      ei = e[eptr]\n    }\n  }\n  while(fptr < nf) {\n    a = fi\n    b = q0\n    x = a + b\n    bv = x - a\n    y = b - bv\n    if(y) {\n      g[count++] = y\n    } \n    _x = q1 + x\n    _bv = _x - q1\n    _av = _x - _bv\n    _br = x - _bv\n    _ar = q1 - _av\n    q0 = _ar + _br\n    q1 = _x\n    fptr += 1\n    if(fptr < nf) {\n      fi = -f[fptr]\n    }\n  }\n  if(q0) {\n    g[count++] = q0\n  }\n  if(q1) {\n    g[count++] = q1\n  }\n  if(!count) {\n    g[count++] = 0.0  \n  }\n  g.length = count\n  return g\n}","// Based on https://wiki.openstreetmap.org/wiki/Slippy_map_tilenames#ECMAScript_.28JavaScript.2FActionScript.2C_etc..29\nexport default class TileConversion {\n  static lon2tile(lon, zoom, rounded = true) {\n    const tile = (lon + 180) / 360 * Math.pow(2, zoom);\n\n    return rounded\n      ? Math.floor(tile)\n      : tile;\n  }\n\n  static lat2tile(lat, zoom, rounded = true) {\n    const tile = (1 - Math.log(Math.tan(lat * Math.PI / 180) + 1 / Math.cos(lat * Math.PI / 180))\n      / Math.PI) / 2 * Math.pow(2, zoom);\n\n    return rounded\n      ? Math.floor(tile)\n      : tile;\n  }\n\n  static tile2lon(x, z) {\n    return x / Math.pow(2, z) * 360 - 180;\n  }\n\n  static tile2lat(y, z) {\n    const n = Math.PI - 2 * Math.PI * y / Math.pow(2, z);\n\n    return 180 / Math.PI * Math.atan(0.5 * (Math.exp(n) - Math.exp(-n)));\n  }\n\n  static tile2boundingBox(x, y, zoom) {\n    return {\n      ne: [\n        TileConversion.tile2lat(y, zoom),\n        TileConversion.tile2lon(x + 1, zoom)\n      ],\n\n      sw: [\n        TileConversion.tile2lat(y + 1, zoom),\n        TileConversion.tile2lon(x, zoom)\n      ]\n    };\n  }\n\n  static pixelToLatLon(pixel, center, zoom, tileSize) {\n    const pointDiff = [\n      pixel[0] / tileSize,\n      pixel[1] / tileSize\n    ];\n\n    const tileX = TileConversion.lon2tile(center[1], zoom, false) - pointDiff[0];\n    const tileY = TileConversion.lat2tile(center[0], zoom, false) - pointDiff[1];\n\n    return [\n      TileConversion.tile2lat(tileY, zoom),\n      TileConversion.tile2lon(tileX, zoom)\n    ];\n  }\n\n  static latLonToPixel(coord, center, zoom, tileSize) {\n    const tileX = TileConversion.lon2tile(coord[1], zoom, false);\n    const tileY = TileConversion.lat2tile(coord[0], zoom, false);\n\n    let tileCenterX = 0, tileCenterY = 0;\n\n    if (center) {\n      tileCenterX = TileConversion.lon2tile(center[1], zoom, false);\n      tileCenterY = TileConversion.lat2tile(center[0], zoom, false);\n    }\n\n    return [\n      -(tileX - tileCenterX) * tileSize,\n      -(tileY - tileCenterY) * tileSize\n    ];\n  }\n}\n","export default class Tile {\n  constructor(x, y, zoom) {\n    this._x = x;\n    this._y = y;\n    this._zoom = zoom;\n  }\n\n  get x() {\n    return this._x;\n  }\n\n  get y() {\n    return this._y;\n  }\n\n  get zoom() {\n    return this._zoom;\n  }\n\n  get id() {\n    return [this.x, this.y, this.zoom].join('|');\n  }\n\n  isValid() {\n    const max = (1 << this.zoom);\n\n    if (this.x >= max || this.x < 0 || this.y >= max || this.y < 0) {\n      return false;\n    }\n\n    return true;\n  }\n}\n","import TileConversion from './TileConversion';\nimport Tile from './Tile';\n\nexport default class TileLayer {\n\n  constructor(map, tilesZoomLevel = null) {\n    this.map = map;\n    this.tilesZoomLevel = tilesZoomLevel;\n\n    this.context = map.context;\n\n    this.state = {\n      grid: [],\n      gridHash: null,\n      relativeTileOffset: [0, 0]\n    };\n  }\n\n  toJSON() {\n    return [\n      this.state,\n      this.loadedPercentage() // We want a change in loaded tiles to possibly trigger a redraw\n    ];\n  }\n\n  getTilesCount(canvasSize) {\n    let tilesCount = Math.ceil(canvasSize / this.map.options.tileSize) * this.map.options.tileAreaMultiplier;\n\n    if (tilesCount % 2 === 0) {\n      tilesCount++;\n    }\n\n    return tilesCount;\n  }\n\n  calculateGrid() {\n    const { state, options } = this.map;\n\n    const centerY = TileConversion.lat2tile(options.center[0], Math.round(this.tilesZoomLevel || options.zoom), false);\n    const centerX = TileConversion.lon2tile(options.center[1], Math.round(this.tilesZoomLevel || options.zoom), false);\n    const gridHash = [centerY, centerX].join(',');\n\n    const gridNeedsToBeUpdated = this.state.gridHash !== gridHash;\n\n    if (!gridNeedsToBeUpdated) {\n      return;\n    }\n\n    const horizontalTiles = this.getTilesCount(state.canvasDimensions[0]);\n    const verticalTiles = this.getTilesCount(state.canvasDimensions[1]);\n\n    // noinspection JSSuspiciousNameCombination\n    const centerYRounded = Math.floor(centerY);\n    const centerXRounded = Math.floor(centerX);\n\n    this.state.relativeTileOffset = [\n      Math.abs(centerX - centerXRounded),\n      Math.abs(centerY - centerYRounded)\n    ];\n\n    const startX = centerXRounded - Math.floor(horizontalTiles / 2);\n    const startY = centerYRounded - Math.floor(verticalTiles / 2);\n\n    let grid = [];\n\n    for (let y = 0; y < verticalTiles; y++) {\n      for (let x = 0; x < horizontalTiles; x++) {\n        if (!grid[x]) {\n          grid[x] = [];\n        }\n\n        const tileX = startX + x;\n        const tileY = startY + y;\n\n        const tile = new Tile(tileX, tileY, Math.round(this.tilesZoomLevel || options.zoom));\n\n        if (tile.isValid()) {\n          this.ensureTileAsset(tile);\n          grid[x][y] = tile;\n        }\n      }\n    }\n\n    this.state.grid = grid;\n    this.state.gridHash = gridHash;\n  }\n\n  ensureTileAsset(tile) {\n    if (!(tile.id in this.map.state.tiles)) {\n      const tileUrl = this.map.options.source(Math.floor(tile.x), Math.floor(tile.y), tile.zoom);\n\n      this.map.state.tiles[tile.id] = new Image();\n      this.map.state.tiles[tile.id].crossOrigin = 'Anonymous';\n      this.map.state.tiles[tile.id].tileId = tile.id;\n      this.map.state.tiles[tile.id].src = tileUrl;\n      this.map.state.tiles[tile.id].loaded = false;\n      this.map.state.tiles[tile.id].onload = () => {\n        this.map.state.tiles[tile.id].loaded = true;\n      };\n    }\n\n    this.map.state.tiles[tile.id].lastRequested = new Date().getTime();\n  }\n\n  drawTiles(scale) {\n    const canvasWidth = this.map.state.canvasDimensions[0];\n    const canvasHeight = this.map.state.canvasDimensions[1];\n\n    const tileSize = this.map.options.tileSize * scale;\n\n    const centerOffset = [\n      tileSize / 2 - (this.state.relativeTileOffset[0] * tileSize),\n      tileSize / 2 - (this.state.relativeTileOffset[1] * tileSize)\n    ];\n\n    this.context.fillStyle = '#EEE';\n    this.context.fillRect(0, 0, canvasWidth, canvasHeight);\n\n    const horizontalTiles = this.getTilesCount(canvasWidth);\n    const verticalTiles = this.getTilesCount(canvasHeight);\n\n    const horizontalOverflow = (horizontalTiles * tileSize) - canvasWidth;\n    const verticalOverflow = (verticalTiles * tileSize) - canvasHeight;\n\n    for (let y = 0; y < verticalTiles; y++) {\n      for (let x = 0; x < horizontalTiles; x++) {\n        const tile = this.state.grid[x][y];\n\n        if (tile) {\n          const tileX = this.map.state.moveOffset[0] + centerOffset[0]\n            + (x * tileSize - horizontalOverflow / 2);\n\n          const tileY = this.map.state.moveOffset[1] + centerOffset[1]\n            + (y * tileSize - verticalOverflow / 2);\n\n          try {\n            if (this.map.state.tiles[tile.id].loaded) {\n              this.context.drawImage(this.map.state.tiles[tile.id], tileX, tileY, tileSize, tileSize);\n            } else {\n              this.drawGenericBackground(tileX, tileY, tileSize);\n            }\n          } catch (err) {\n            this.drawGenericBackground(tileX, tileY, tileSize);\n          }\n\n          if (this.map.options.debug) {\n            this.context.strokeStyle = 'green';\n            this.context.strokeRect(tileX, tileY, tileSize, tileSize);\n          }\n        }\n      }\n    }\n\n    if (this.map.options.debug) {\n      this.context.fillStyle = 'rgba(200, 0, 0, 0.7)';\n      this.context.beginPath();\n      this.context.arc(canvasWidth / 2, canvasHeight / 2, 5, 0, 2 * Math.PI);\n      this.context.fill();\n    }\n  }\n\n  drawGenericBackground(x, y, size) {\n    const increment = size / 8;\n\n    this.context.beginPath();\n    for (let lineX = increment; lineX < size; lineX += increment) {\n      for (let lineY = increment; lineY < size; lineY += increment) {\n        this.context.moveTo(x, y + lineY);\n        this.context.lineTo(x + size, y + lineY);\n\n        this.context.moveTo(x + lineX, y);\n        this.context.lineTo(x + lineX, y + size);\n      }\n    }\n    this.context.strokeStyle = '#DDD';\n    this.context.stroke();\n\n    this.context.strokeStyle = '#CCC';\n    this.context.strokeRect(x, y, size, size);\n  }\n\n  loadedPercentage() {\n    const horizontalTiles = this.getTilesCount(this.map.state.canvasDimensions[0]);\n    const verticalTiles = this.getTilesCount(this.map.state.canvasDimensions[1]);\n\n    let totalTiles = 0, loadedTiles = 0;\n\n    for (let y = 0; y < verticalTiles; y++) {\n      for (let x = 0; x < horizontalTiles; x++) {\n        const tile = this.state.grid[x][y];\n\n        if (tile) {\n          totalTiles++;\n        }\n\n        const cachedTile = tile && this.map.state.tiles[tile.id];\n\n        if (cachedTile && cachedTile.loaded) {\n          loadedTiles++;\n        }\n      }\n    }\n\n    return loadedTiles / totalTiles;\n  }\n}\n","export default class MapState {\n  constructor(center, zoom, targetZoom, tileSize, canvasDimensions, canvasCenter, moveOffset) {\n    this._center = center;\n    this._zoom = zoom;\n    this._targetZoom = targetZoom;\n    this._tileSize = tileSize;\n    this._canvasDimensions = canvasDimensions;\n    this._canvasCenter = canvasCenter;\n    this._moveOffset = moveOffset;\n  }\n\n  get center() {\n    return this._center;\n  }\n\n  get zoom() {\n    return this._zoom;\n  }\n\n  get targetZoom() {\n    return this._targetZoom;\n  }\n\n  get tileSize() {\n    return this._tileSize;\n  }\n\n  get canvasDimensions() {\n    return this._canvasDimensions;\n  }\n\n  get canvasCenter() {\n    return this._canvasCenter;\n  }\n\n  get moveOffset() {\n    return this._moveOffset;\n  }\n}\n","import TileConversion from './TileConversion';\n\nexport default class MarkerRenderer {\n  constructor(renderMode) {\n    this._markers = [];\n    this.offscreenCanvas = null;\n    this.renderedMapCenter = null;\n    this.renderedZoomLevel = null;\n  }\n\n  get markers() {\n    return this._markers;\n  }\n\n  set markers(markers) {\n    this._markers = markers;\n  }\n\n  determineOriginZoom(mapState) {\n    let originZoom = mapState.zoom;\n\n    if (mapState.targetZoom > mapState.zoom) { // Zoming in\n      originZoom = Math.floor(mapState.zoom);\n    } else if (mapState.targetZoom < mapState.zoom) { // Zooming out\n      originZoom = Math.ceil(mapState.zoom);\n    }\n\n    return originZoom;\n  }\n\n  render(context, mapState, mapBounds, forceRerender = false) {\n    const originZoom = this.determineOriginZoom(mapState);\n\n    const zoomDiff = originZoom\n      ? mapState.zoom - originZoom\n      : 0;\n\n    const scale = zoomDiff !== 0\n      ? Math.pow(2, zoomDiff)\n      : 1.0;\n\n    if (forceRerender || this.shouldReRender(mapState, zoomDiff)) {\n      this.renderOffScreenCanvas(mapState, mapBounds);\n    }\n\n    if (scale < 1.5 || scale > 0.5) {\n      const canvasDrawPosition = [\n        mapState.moveOffset[0] - (mapState.canvasCenter[0] * (scale - 1)),\n        mapState.moveOffset[1] - (mapState.canvasCenter[1] * (scale - 1))\n      ];\n\n      const canvasDrawDimensions = [\n        mapState.canvasDimensions[0] * scale,\n        mapState.canvasDimensions[1] * scale\n      ];\n\n      context.drawImage(\n        this.offscreenCanvas,\n        canvasDrawPosition[0], canvasDrawPosition[1],\n        canvasDrawDimensions[0], canvasDrawDimensions[1],\n      );\n    }\n  }\n\n  shouldReRender(mapState, zoomDiff) {\n    const mapCenterChanged = this.renderedMapCenter !== mapState.center,\n      mapZoomChanged = (zoomDiff === 0 && this.renderedZoomLevel !== mapState.zoom);\n\n    return this.offscreenCanvas === null || mapCenterChanged || mapZoomChanged;\n  }\n\n  renderOffScreenCanvas(mapState, mapBounds) {\n    this.renderedZoomLevel = mapState.zoom;\n    this.renderedMapCenter = mapState.center;\n\n    const context = this.createOffscreenCanvas(mapState.canvasDimensions);\n    const visibleMarkers = this.getVisibleMarkers(mapBounds);\n\n    visibleMarkers.forEach(marker => {\n      const position = TileConversion.latLonToPixel(\n        marker.coords,\n        mapState.center,\n        mapState.zoom,\n        mapState.tileSize\n      );\n\n      marker.render(context, [\n        mapState.canvasCenter[0] - position[0],\n        mapState.canvasCenter[1] - position[1]\n      ], mapState.zoom);\n    });\n  }\n\n  createOffscreenCanvas(canvasDimensions) {\n    this.offscreenCanvas = document.createElement('canvas');\n    this.offscreenCanvas.width = canvasDimensions[0];\n    this.offscreenCanvas.height = canvasDimensions[1];\n\n    return this.offscreenCanvas.getContext('2d');\n  }\n\n  getVisibleMarkers(bounds) {\n    return this.markers.filter(marker => {\n      return marker.coords[0] <= bounds.nw[0] && marker.coords[0] >= bounds.se[0]\n        && marker.coords[1] >= bounds.nw[1] && marker.coords[1] <= bounds.se[1];\n    });\n  }\n\n  getMarkersBounds(mapState, mapBounds) {\n    return this.getVisibleMarkers(mapBounds).map(marker => {\n      const position = TileConversion.latLonToPixel(\n        marker.coords,\n        mapState.center,\n        mapState.zoom,\n        mapState.tileSize\n      );\n\n      const markerSize = marker.size;\n      const markerOffset = marker.offset;\n\n      return {\n        bounds: {\n          x: mapState.canvasCenter[0] - position[0] + mapState.moveOffset[0] - (markerSize[0] / 2) + markerOffset[0],\n          y: mapState.canvasCenter[1] - position[1] + mapState.moveOffset[1] - (markerSize[1] / 2) + markerOffset[1],\n          width: markerSize[0],\n          height: markerSize[1]\n        },\n        marker\n      };\n    });\n  }\n}\n","export const defaultMapOptions = {\n  /**\n   * Common options\n   */\n  source: (x, y, z) => `https://maps.geocod.io/tiles/base/${z}/${x}/${y}.png`,\n  zoom: 12,\n  center: [38.841779, -77.088312],\n  attribution: ' OpenStreetMap contributors',\n\n  /**\n   * Enable to make map controls visible only when mouse is hovered over the canvas\n   */\n  hideControlsUntilActive: true,\n\n  /**\n   * Define how markers should be rendered:\n   * standard: Render markers individually at all zoom levels\n   * cluster: Group markers into clusters at lower zoom levels\n   */\n  markerRenderMode: 'standard',\n\n  /**\n   * Width and height in pixels for each tile, you most likely do not want to change this.\n   */\n  tileSize: 256,\n\n  /**\n   * Determines the distance travelled when panning the map, the higher the value the further the\n   * distance\n   */\n  panAccelerationMultiplier: 2,\n\n  /**\n   * The maximum acceleration constant for when the map is thrown. This is in place to avoid\n   * super-sonic acceleration speeds :)\n   */\n  maxPanAcceleration: 3.5,\n\n  /**\n   * Only consider high velocity mouse movements that has been performed within this timing\n   * threshold (in milliseconds)\n   */\n  throwTimingThresholdMs: 100,\n\n  /**\n   * If the mouse panning velocity is above this threshold, it is considering a throw rather than\n   * a regular pan. We use this to pan further when the mouse is moved quickly\n   */\n  throwVelocityThreshold: 3000,\n\n  /**\n   * How quickly panning and zooming animations are executed (in milliseconds)\n   */\n  animationDurationMs: 300,\n\n  /*\n   * Used for debouncing events such as scrolling\n   * Note: Needs to be greater than the animationDurationMs value\n   */\n  debounceIntervalMs: 350,\n\n  /**\n   * Determines how many additional tiles that should be loaded, to decrease map load times when\n   * panning the map around\n\n   * Minimum value: 1.25\n   */\n  tileAreaMultiplier: 2,\n\n  /**\n   * When debug mode is enabled, additional rendering artifacts are drawn. Should only be used in\n   * conjuction with development of the library\n   */\n  debug: false,\n\n  /**\n   * Whether debug logs should be enabled. Should only be used in conjuction with development\n   * of the library\n   */\n  log: false\n};\n\nexport const defaultMarkerOptions = {\n  /**\n   * What color should the marker be?\n   * Supports hex, rgb and rgba values\n   */\n  color: 'rgba(0, 0, 200, 0.7)',\n\n  /**\n   * Valid values: marker, circle, donut, image\n   */\n  type: 'marker',\n\n  /**\n   * Image object for the rendered icon\n   * Note: Only used for markers with the \"image\" type\n   */\n  image: null,\n\n  /**\n   * Horizontal and vertical offset.\n   * When the offset is set to [0,0], the image is centered horizontally and vertically.\n   * You might for example want add a vertical offset to teardrop-shaped marker icons\n   * Note: Only used for markers with the \"image\" type\n   */\n  offset: [0, 0],\n\n  /**\n   * Whether the marker should have small circular shadow, marking the location\n   * Only applicable when type is marker or image\n   */\n  enableShadow: true,\n\n  /**\n   * Whether the marker should have a stroked line\n   * Only applicable when type is circle\n   */\n  enableStroke: false,\n\n  /**\n   * What color should the border be?\n   * Supports hex, rgb and rgba values\n   * Only applicable when enableStroke is true and type is circle\n   */\n  strokeStyle: 'rgba(100, 100, 100, 0.9)',\n\n  /**\n   * Specify the thickness of marker border\n   * Only applicable when enableStroke is true and type is circle\n   */\n  lineWidth: 2.5\n};\n\nexport const defaultPolygonOptions = {\n  /**\n   * Whether the polygon should have a stroked line\n   */\n  enableStroke: true,\n\n  /**\n   * What color should the polygon lines be?\n   * Supports hex, rgb and rgba values\n   */\n  strokeStyle: 'rgba(50, 25, 50, 1.0)',\n\n  /**\n   * Specify distances to alternately draw a line and a gap to form\n   * a dashed or dotted line. Line will be solid if array is empty\n   */\n  lineDash: [],\n\n  /**\n   * Specify the thickness of polygon lines. The width scales with the zoom level, so the actual\n   * width in pixels is: lineWidth * zoom\n   */\n  lineWidth: 0.25,\n\n  /**\n   * Whether the polygon should be filled with a color\n   */\n  enableFill: true,\n\n  /**\n   * What color should the polygon be filled with?\n   * Supports hex, rgb and rgba values\n   */\n  fillStyle: 'rgba(0, 0, 0, 0.2)',\n\n  /**\n   * When a polygon is set to be non-interactive it will not have a hover state or emit hover events\n   */\n  interactive: true\n};\n\nexport const defaultPolygonHoverOptions = {\n  strokeStyle: 'red',\n  lineWidth: 0.5\n};\n\n","import TileConversion from './TileConversion';\nimport TileLayer from './TileLayer';\nimport MapState from './MapState';\nimport MarkerRenderer from './MarkerRenderer';\nimport { defaultMapOptions } from './defaultOptions';\n\nexport default class Map {\n\n  constructor(canvas, options) {\n    if (!canvas || !canvas.getContext) {\n      throw new Error('Could not get canvas context');\n    }\n\n    this.canvas = canvas;\n    this.context = this.canvas.getContext('2d');\n\n    this.options = Object.assign({}, defaultMapOptions, options);\n\n    this.initializeState();\n    this.attachEvents();\n\n    this.lastDrawState = null;\n\n    /**\n     * Events\n     */\n    this.onMarkerClicked = null;\n    this.onMarkerHover = null;\n    this.onPolygonClicked = null;\n    this.onPolygonHover = null;\n    this.onMapCenterChanged = null;\n    this.onMapZoomChanged = null;\n    this.onMapPanned = null;\n\n    this.draw = this.draw.bind(this);\n    window.requestAnimationFrame(this.draw);\n  }\n\n  initializeState() {\n    this.state = {\n      canvasDimensions: [this.canvas.width, this.canvas.height],\n      tiles: {},\n      moveOffset: [0, 0],\n      targetMoveOffset: [0, 0],\n      targetMoveOffsetIsCoord: false,\n      moveAnimationStart: null,\n      dragStartPosition: null,\n      lastZoomEventActionTime: null,\n      startZoom: this.options.zoom,\n      targetZoom: this.options.zoom,\n      zoomAnimationStart: null,\n      scale: 1,\n      lastMouseMoveEvent: null,\n      mouseVelocities: [],\n      markerRenderer: new MarkerRenderer(this.options.markerRenderMode),\n      polygons: [],\n      tileLayers: [\n        new TileLayer(this)\n      ],\n      mousePosition: { x: -1, y: -1},\n      forceRedraw: false,\n      forceRerenderMarkers: false\n    };\n  }\n\n  getZoom() {\n    return this.options.zoom;\n  }\n\n  setZoom(zoom) {\n    if (this.zoomValueIsValid(zoom) && this.isReadyForZoomEvent()) {\n      zoom = Math.round(zoom);\n\n      this.state.tileLayers.push(new TileLayer(this, zoom));\n\n      this.state.lastZoomEventActionTime = window.performance.now();\n      this.state.zoomAnimationStart = window.performance.now();\n      this.state.targetZoom = zoom;\n      this.state.startZoom = this.options.zoom;\n    }\n  }\n\n  setCenter(coord) {\n    if (!Array.isArray(coord) || coord.length !== 2) {\n      throw new Error('Please provide a valid array with a lat/lon');\n    }\n\n    coord = coord.map(coord => parseFloat(coord));\n\n    this.state.moveAnimationStart = window.performance.now();\n    this.state.targetMoveOffset = coord;\n    this.state.targetMoveOffsetIsCoord = true;\n  }\n\n  setTargetMoveOffset(x, y, animated = true) {\n    this.onMapPanned && this.onMapPanned([x, y]);\n\n    if (animated) {\n      this.state.moveAnimationStart = window.performance.now();\n\n      this.state.targetMoveOffset = TileConversion.pixelToLatLon(\n        [x, y],\n        this.options.center,\n        this.options.zoom,\n        this.options.tileSize\n      );\n\n      this.state.targetMoveOffsetIsCoord = true;\n    } else {\n      this.state.targetMoveOffset = [x, y];\n      this.state.targetMoveOffsetIsCoord = false;\n\n      this.state.moveOffset = this.state.targetMoveOffset;\n    }\n  }\n\n  zoomValueIsValid(zoom) {\n    return zoom >= 1 && zoom <= 18;\n  }\n\n  isReadyForZoomEvent() {\n    if (!this.state.lastZoomEventActionTime) {\n      return true;\n    }\n\n    const now = window.performance.now();\n    const milliSecondsSinceLastEvent = now - this.state.lastZoomEventActionTime;\n\n    return milliSecondsSinceLastEvent > this.options.debounceIntervalMs;\n  }\n\n  calculateVelocity(position1, position2, time1, time2) {\n    return ((position1 - position2) / (time1 - time2)) * 1000;\n  }\n\n  attachEvents() {\n    this.canvas.addEventListener('wheel', event => {\n      event.preventDefault();\n\n      if (event.deltaY > 5) {\n        this.setZoom(this.options.zoom - 1);\n      } else if (event.deltaY < -5) {\n        this.setZoom(this.options.zoom + 1);\n      }\n    });\n\n    this.canvas.addEventListener('dblclick', event => {\n      event.preventDefault();\n      this.updateMousePosition(event);\n\n      if (!this.handleMouseEventInteraction(event, 'dblclick')) {\n        const canvasCenter = this.getCanvasCenter();\n\n        this.setTargetMoveOffset(\n          -(this.state.mousePosition.x - canvasCenter[0]),\n          -(this.state.mousePosition.y - canvasCenter[1])\n        );\n\n        this.setZoom(this.options.zoom + 1);\n      }\n    });\n\n    this.canvas.addEventListener('mousedown', event => {\n      event.preventDefault();\n      this.updateMousePosition(event);\n\n      if (!this.handleMouseEventInteraction(event, 'mousedown')) {\n        this.state.mouseVelocities = [];\n\n        this.state.dragStartPosition = [\n          this.state.mousePosition.x - this.state.moveOffset[0],\n          this.state.mousePosition.y - this.state.moveOffset[1]\n        ];\n      }\n    });\n\n    this.canvas.addEventListener('mouseup', event => {\n      event.preventDefault();\n      this.updateMousePosition(event);\n\n      if (!this.state.dragStartPosition) {\n        this.handleMouseEventInteraction(event, 'mouseup');\n      } else {\n        const x = -(this.state.dragStartPosition[0] - this.state.mousePosition.x);\n        const y = -(this.state.dragStartPosition[1] - this.state.mousePosition.y);\n\n        this.state.dragStartPosition = null;\n\n        const dragDistanceBelowThreshold = Math.abs(x) <= 5 && Math.abs(y) <= 5;\n\n        if (dragDistanceBelowThreshold) {\n          this.handleMouseEventInteraction(event, 'mouseup');\n        } else {\n          if (this.state.moveOffset[0] !== 0 || this.state.moveOffset[1] !== 0) {\n            const now = window.performance.now();\n            const timingThreshold = now - this.options.throwTimingThresholdMs;\n\n            const thresholdsToConsider = this.state.mouseVelocities\n              .filter(threshold => threshold[0] > timingThreshold)\n              .map(threshold => threshold[1]);\n\n            const velocitySum = thresholdsToConsider.reduce(\n              (accumulator, velocity) => accumulator + velocity,\n              0\n            );\n\n            const averageVelocity = velocitySum / thresholdsToConsider.length;\n\n            if (averageVelocity >= this.options.throwVelocityThreshold) {\n              let multiplier = averageVelocity / this.options.throwVelocityThreshold\n                * this.options.panAccelerationMultiplier;\n\n              multiplier = Math.min(multiplier, this.options.maxPanAcceleration);\n\n              this.setTargetMoveOffset(\n                x * multiplier,\n                y * multiplier\n              );\n            } else {\n              this.updateCenter();\n            }\n          }\n        }\n      }\n    });\n\n    this.canvas.addEventListener('mousemove', event => {\n      event.preventDefault();\n      this.updateMousePosition(event);\n\n      if (this.state.dragStartPosition) {\n        const x = -(this.state.dragStartPosition[0] - this.state.mousePosition.x);\n        const y = -(this.state.dragStartPosition[1] - this.state.mousePosition.y);\n\n        const now = window.performance.now();\n\n        const vx = this.calculateVelocity(this.state.moveOffset[0], x, now, this.state.lastMouseMoveEvent);\n        const vy = this.calculateVelocity(this.state.moveOffset[1], y, now, this.state.lastMouseMoveEvent);\n\n        const velocity = Math.round(Math.sqrt((vx * vx) + (vy * vy)));\n\n        this.state.mouseVelocities.push([now, velocity]);\n\n        this.setTargetMoveOffset(x, y, false);\n\n        this.state.lastMouseMoveEvent = window.performance.now();\n      } else {\n        this.handleMouseEventInteraction(event, 'mousemove');\n      }\n\n      return false;\n    });\n\n    this.canvas.addEventListener('mouseleave', event => {\n      if (this.options.hideControlsUntilActive) {\n        this.state.showControls = false;\n      }\n\n      this.updateMousePosition(null);\n    });\n\n    this.canvas.addEventListener('mouseenter', event => {\n      if (this.options.hideControlsUntilActive) {\n        this.state.showControls = true;\n      }\n    });\n  }\n\n  isCurrentlyDraggingMap() {\n    return this.state.dragStartPosition !== null;\n  }\n\n  enablePolygonInteractivity() {\n    return this.onPolygonHover || this.onPolygonClicked;\n  }\n\n  updateMousePosition(event) {\n    if (event) {\n      const rect = this.canvas.getBoundingClientRect();\n\n      this.state.mousePosition = {\n        x: event.clientX - rect.left,\n        y: event.clientY - rect.top\n      };\n    } else {\n      this.state.mousePosition = {\n        x: -1,\n        y: -1\n      };\n    }\n  }\n\n  easeOutQuad(time) {\n    return time * (2 - time);\n  }\n\n  updateMoveOffset() {\n    const targetMoveOffset = this.state.targetMoveOffsetIsCoord\n      ? TileConversion.latLonToPixel(\n        this.state.targetMoveOffset,\n        this.options.center,\n        this.options.zoom,\n        this.options.tileSize\n      )\n      : this.state.targetMoveOffset;\n\n    const moveOffsetNeedsToBeUpdated = this.state.moveOffset.join(',') !== targetMoveOffset.join(',');\n\n    if (moveOffsetNeedsToBeUpdated) {\n      const timestamp = window.performance.now();\n\n      const progress = Math.max(timestamp - this.state.moveAnimationStart, 0);\n      const percentage = this.easeOutQuad(progress / this.options.animationDurationMs);\n\n      if (percentage >= 0.99 || percentage < 0) {\n        this.state.moveOffset = targetMoveOffset;\n      } else {\n        this.state.moveOffset = [\n          this.state.moveOffset[0] + (targetMoveOffset[0] - this.state.moveOffset[0]) * percentage,\n          this.state.moveOffset[1] + (targetMoveOffset[1] - this.state.moveOffset[1]) * percentage\n        ];\n      }\n\n      const targetHasBeenReached = this.state.moveOffset.join(',') === targetMoveOffset.join(',');\n\n      if (targetHasBeenReached) {\n        this.state.targetMoveOffsetIsCoord = false;\n\n        this.updateCenter();\n      }\n    }\n  }\n\n  updateCenter() {\n    const latLon = TileConversion.pixelToLatLon(\n      this.state.moveOffset,\n      this.options.center,\n      this.options.zoom,\n      this.options.tileSize\n    );\n\n    this.setTargetMoveOffset(0, 0, false);\n    this.options.center = latLon;\n\n    this.onMapCenterChanged && this.onMapCenterChanged(this.options.zoom, this.options.center);\n  }\n\n  updateZoom() {\n    if (this.options.zoom !== this.state.targetZoom) {\n      const progress = Math.max(window.performance.now() - this.state.zoomAnimationStart, 0);\n      const percentage = this.easeOutQuad(progress / this.options.animationDurationMs);\n\n      let differenceFromTarget = Math.abs(this.state.targetZoom - this.state.startZoom);\n\n      if (this.state.targetZoom <= this.state.startZoom) {\n        differenceFromTarget *= -1;\n      }\n\n      const newZoomDiff = differenceFromTarget * percentage;\n      const remainingTime = this.options.animationDurationMs - progress;\n\n      this.options.zoom = remainingTime <= 5\n        ? this.state.targetZoom\n        : (this.state.startZoom + newZoomDiff);\n\n      const roundedZoom = Math.round(this.options.zoom);\n      const diff = this.options.zoom - roundedZoom;\n\n      this.state.scale = Math.pow(2, diff);\n\n      if (this.options.zoom === this.state.targetZoom) {\n        // Mark old tile layer for deletion\n        this.state.tileLayers.shift();\n        this.state.tileLayers[0].tilesZoomLevel = null;\n\n        this.onMapZoomChanged && this.onMapZoomChanged(this.options.zoom, this.options.center);\n      }\n    } else {\n      this.state.scale = 1;\n    }\n  }\n\n  garbageCollect() {\n    const allTiles = Object.values(this.state.tiles);\n\n    if (allTiles.length > this.maxTilesToKeep()) {\n      const tileExpirationCutOff = new Date().getTime() - 5000;\n\n      const tilesToConsider = allTiles\n        .filter(tile => tile.lastRequested < tileExpirationCutOff)\n        .sort((a, b) => ~~(a.lastRequested < b.lastRequested));\n\n      const tilesToDeleteCount = this.maxTilesToKeep() - (allTiles.length - tilesToConsider.length);\n\n      tilesToConsider\n        .splice(tilesToConsider.length - tilesToDeleteCount)\n        .forEach(tile => {\n          tile.src = '';\n          delete this.state.tiles[tile.tileId];\n        });\n    }\n  }\n\n  snapshotMapState() {\n    return new MapState(\n      this.options.center,\n      this.options.zoom,\n      this.state.targetZoom,\n      this.options.tileSize,\n      this.state.canvasDimensions,\n      this.getCanvasCenter(),\n      this.state.moveOffset\n    );\n  }\n\n  maxTilesToKeep() {\n    return 1000;\n  }\n\n  shouldRedraw() {\n    if (this.state.forceRedraw) {\n      this.state.forceRedraw = false;\n\n      return true;\n    }\n\n    const drawState = JSON.stringify([this.state, this.options]);\n\n    if (this.lastDrawState !== drawState) {\n      this.lastDrawState = drawState;\n\n      return true;\n    }\n\n    return false;\n  }\n\n  draw() {\n    this.options.log && console.log(this.snapshotMapState());\n\n    this.updateMoveOffset();\n    this.updateZoom();\n    this.state.tileLayers.forEach(tileLayer => tileLayer.calculateGrid());\n    this.garbageCollect();\n\n    if (this.shouldRedraw()) {\n      if (this.state.tileLayers.length > 0) {\n        // Only draw the top layer\n        this.state.tileLayers[0].drawTiles(this.state.scale);\n      }\n\n      const mapState = this.snapshotMapState();\n\n      this.renderPolygons(mapState);\n      this.renderMarkers(mapState);\n      this.renderControls();\n      this.renderAttribution();\n    }\n\n    window.requestAnimationFrame(this.draw);\n  }\n\n  getMapBounds() {\n    const canvasCenter = this.getCanvasCenter();\n\n    const nw = TileConversion.pixelToLatLon(\n      [canvasCenter[0], canvasCenter[1]],\n      this.options.center,\n      this.options.zoom,\n      this.options.tileSize\n    );\n\n    const se = TileConversion.pixelToLatLon(\n      [-canvasCenter[0], -canvasCenter[1]],\n      this.options.center,\n      this.options.zoom,\n      this.options.tileSize\n    );\n\n    return {\n      nw, se\n    };\n  }\n\n  getCanvasCenter() {\n    return [\n      this.state.canvasDimensions[0] / 2,\n      this.state.canvasDimensions[1] / 2\n    ];\n  }\n\n  renderMarkers(mapState) {\n    this.state.markerRenderer.render(this.context, mapState, this.getMapBounds(), this.state.forceRerenderMarkers);\n    this.state.forceRerenderMarkers = false;\n  }\n\n  renderPolygons(mapState) {\n    this.state.polygons.map(polygon => {\n      polygon.render(this.context, mapState);\n\n      if (this.enablePolygonInteractivity() && !this.isCurrentlyDraggingMap()) {\n        polygon.handleMouseOver(this.context, mapState, this.state.mousePosition);\n      }\n    });\n  }\n\n  handleMouseEventInteraction(event, name) {\n    const controlObjects = this.getControlObjects().filter(item => this.isMouseOverObject(item.bounds));\n    const shouldEmitMarkerEvents = controlObjects.length <= 0 && (this.onMarkerClicked || this.onMarkerHover);\n\n    const markers = shouldEmitMarkerEvents\n      ? this.state.markerRenderer.getMarkersBounds(this.snapshotMapState(), this.getMapBounds())\n        .filter(item => this.isMouseOverObject(item.bounds))\n      : [];\n\n    const firstMarker = markers[0] || null;\n\n    if (name === 'mouseup') {\n      if (controlObjects.length > 0) {\n        const controlObject = controlObjects[0];\n\n        this.setZoom(controlObject.label === '+'\n          ? this.options.zoom + 1\n          : this.options.zoom - 1);\n      }\n\n      if (this.onMarkerClicked && firstMarker) {\n        this.onMarkerClicked(firstMarker.marker);\n      }\n    } else {\n      if (this.onMarkerHover && firstMarker) {\n        this.onMarkerHover(firstMarker.marker);\n      }\n    }\n\n    let controlsOrMarkersIsHover = controlObjects.length > 0 || firstMarker;\n\n    let polygonIsHover = false;\n\n    if (this.enablePolygonInteractivity() && !this.isCurrentlyDraggingMap() && !controlsOrMarkersIsHover) {\n      let polygons = [];\n\n      const mapState = this.snapshotMapState();\n\n      polygons = this.state.polygons.map(polygon => {\n        return {\n          polygon,\n          activatedAreas: polygon.handleMouseOver(null, mapState, this.state.mousePosition)\n        };\n      }).filter(polygon => polygon.activatedAreas.length > 0);\n\n      polygonIsHover = polygons.length > 0;\n\n      if (polygonIsHover) {\n        const eventHandler = (name === 'mouseup')\n          ? this.onPolygonClicked\n          : this.onPolygonHover;\n\n        if (eventHandler) {\n          polygons.map(polygon => polygon.activatedAreas.map(item => eventHandler(item, polygon.polygon.meta)));\n        }\n      }\n    }\n\n    this.canvas.style.cursor = controlsOrMarkersIsHover || polygonIsHover\n      ? 'pointer'\n      : 'grab';\n\n    // Let caller know if controls or markers were interacted with. This will prevent further\n    // mouse interactions from being triggered\n    return controlsOrMarkersIsHover;\n  }\n\n  getControlObjects() {\n    const margin = 4;\n    const size = 30;\n\n    return [\n      {\n        bounds: {\n          x: margin,\n          y: margin,\n          width: size,\n          height: size\n        },\n        label: '+'\n      },\n      {\n        bounds: {\n          x: margin,\n          y: margin + size + margin,\n          width: size,\n          height: size\n        },\n        label: '-'\n      }\n    ];\n  }\n\n  renderControls() {\n    if (this.state.showControls) {\n      this.getControlObjects().map(item => this.renderControl(item.bounds, item.label));\n    }\n  }\n\n  renderControl(bounds, label) {\n    const radius = 10;\n\n    // Background\n    this.context.fillStyle = this.isMouseOverObject(bounds)\n      ? 'rgba(100, 100, 100, 0.7)'\n      : 'rgba(0, 0, 0, 0.7)';\n\n    this.roundedRectangle(bounds.x, bounds.y, bounds.width, bounds.height, radius);\n\n    // Text\n    this.context.font = 'bold 25px courier';\n    this.context.textAlign = 'center';\n    this.context.textBaseline = 'middle';\n    this.context.fillStyle = '#fff';\n\n    this.context.fillText(\n      label,\n      bounds.x + (bounds.width / 2),\n      bounds.y + (bounds.height / 2)\n    );\n  }\n\n  isMouseOverObject(bounds) {\n    return this.state.mousePosition.x >= bounds.x\n      && this.state.mousePosition.x <= bounds.x + bounds.width\n      && this.state.mousePosition.y >= bounds.y\n      && this.state.mousePosition.y <= bounds.y + bounds.height;\n  }\n\n  renderAttribution() {\n    const margin = 4;\n\n    this.context.font = 'bold 12px sans-serif';\n    this.context.textAlign = 'left';\n    this.context.textBaseline = 'alphabetic';\n\n    const textBounds = this.context.measureText(this.options.attribution);\n\n    const x = this.state.canvasDimensions[0] - textBounds.width - margin;\n    const y = this.state.canvasDimensions[1] - 2 - margin;\n\n    this.context.fillStyle = 'rgba(255, 255, 255, 0.7)';\n    this.roundedRectangle(x - margin, y - 15, textBounds.width + 80, 80);\n\n    this.context.fillStyle = 'rgba(0, 0, 0, 0.7)';\n    this.context.fillText(this.options.attribution, x, y);\n  }\n\n  roundedRectangle(x, y, width, height, radius = 5) {\n    this.context.beginPath();\n    this.context.moveTo(x + radius, y);\n    this.context.lineTo(x + width - radius, y);\n    this.context.quadraticCurveTo(x + width, y, x + width, y + radius);\n    this.context.lineTo(x + width, y + height - radius);\n    this.context.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);\n    this.context.lineTo(x + radius, y + height);\n    this.context.quadraticCurveTo(x, y + height, x, y + height - radius);\n    this.context.lineTo(x, y + radius);\n    this.context.quadraticCurveTo(x, y, x + radius, y);\n    this.context.closePath();\n\n    this.context.fill();\n  }\n\n  addMarkers(markers) {\n    markers.map(marker => this.addMarker(marker));\n  }\n\n  addMarker(marker) {\n    this.state.markerRenderer.markers.push(marker);\n    this.state.forceRedraw = true;\n    this.state.forceRerenderMarkers = true;\n  }\n\n  setMarkers(markers) {\n    this.state.markerRenderer.markers = markers;\n    this.state.forceRedraw = true;\n    this.state.forceRerenderMarkers = true;\n  }\n\n  addPolygon(polygon) {\n    this.state.polygons.push(polygon);\n  }\n\n  setPolygons(polygons) {\n    this.state.polygons = polygons;\n  }\n\n}\n","import { defaultMarkerOptions } from './defaultOptions';\n\nexport default class Marker {\n  constructor(coords, options = {}, meta = {}) {\n    this._coords = coords;\n    this._options = Object.assign({}, defaultMarkerOptions, options);\n    this._meta = meta;\n  }\n\n  get coords() {\n    return this._coords;\n  }\n\n  get options() {\n    return this._options;\n  }\n\n  get meta() {\n    return this._meta;\n  }\n\n  get size() {\n    switch (this.options.type) {\n      case 'marker':\n        return [\n          17.698069,\n          24.786272\n        ];\n\n      case 'circle': {\n        const strokeMargin = this.options.enableStroke\n          ? this.options.lineWidth\n          : 0;\n\n        return [10 + strokeMargin, 10 + strokeMargin];\n      }\n\n      case 'donut':\n        return [14, 14];\n\n      case 'image':\n        return this.options.image\n          ? [this.options.image.width, this.options.image.height]\n          : null;\n\n      default:\n        return null;\n    }\n  }\n\n  get offset() {\n    switch (this.options.type) {\n      case 'marker':\n        return [\n          0,\n          -(this.size[1] / 2)\n        ];\n\n      case 'image':\n        return this.options.offset || [0, 0];\n\n      default:\n        return [0, 0];\n    }\n  }\n\n  render(context, position, mapZoom) {\n    let renderFunction = null;\n\n    switch (this.options.type) {\n      case 'marker':\n        renderFunction = this.renderMarker;\n        break;\n\n      case 'circle':\n        renderFunction = this.renderCircle;\n        break;\n\n      case 'donut':\n        renderFunction = this.renderDonut;\n        break;\n\n      case 'image':\n        renderFunction = this.renderImage;\n        break;\n    }\n\n    if (!renderFunction) {\n      throw new Error(`Unsupported marker type: \"${this.options.type}\"`);\n    } else {\n      renderFunction = renderFunction.bind(this);\n      renderFunction(context, position, mapZoom);\n    }\n  }\n\n  renderCircle(context, position) {\n    context.fillStyle = this.options.color;\n    context.strokeStyle = this.options.strokeStyle;\n    context.lineWidth = this.options.lineWidth;\n\n    context.save();\n    context.beginPath();\n    context.arc(position[0], position[1], this.size[0] / 2, 0, 2 * Math.PI);\n    context.fill();\n\n    if (this.options.enableStroke) {\n      context.stroke();\n    }\n\n    context.restore();\n  }\n\n  renderDonut(context, position) {\n    context.fillStyle = this.options.color;\n    context.strokeStyle = this.options.color;\n\n    context.save();\n    context.beginPath();\n    context.lineWidth = 5;\n    context.arc(position[0], position[1], this.size[0] / 2, 0, 2 * Math.PI);\n    context.stroke();\n    context.restore();\n  }\n\n  renderMarker(context, position, mapZoom) {\n    this.renderShadow(context, position, mapZoom);\n\n    context.fillStyle = this.options.color;\n    context.strokeStyle = this.options.color;\n\n    const size = this.size;\n\n    const x = position[0] - size[0] / 2;\n    const y = position[1] - size[1];\n\n    context.save();\n    context.transform(0.184386, 0.000000, 0.000000, 0.184386, 0.551658 + x, 4.095760 + y);\n    context.beginPath();\n    context.lineWidth = 1.667195;\n    context.moveTo(45.000000, -22.212949);\n    context.bezierCurveTo(18.494941, -22.212949, -2.991863, -0.726145, -2.991863, 25.778914);\n    context.bezierCurveTo(-2.991863, 52.282306, 45.000000, 112.212950, 45.000000, 112.212950);\n    context.bezierCurveTo(45.000000, 112.212950, 92.991863, 52.282306, 92.991863, 25.777247);\n    context.bezierCurveTo(92.991863, -0.726145, 71.505059, -22.212949, 45.000000, -22.212949);\n    context.moveTo(45.000000, 43.827962);\n    context.bezierCurveTo(33.553042, 43.827962, 24.273437, 34.550024, 24.273437, 23.103067);\n    context.bezierCurveTo(24.273437, 11.656109, 33.553042, 2.376504, 45.000000, 2.376504);\n    context.bezierCurveTo(56.446958, 2.376504, 65.726563, 11.654442, 65.726563, 23.101399);\n    context.bezierCurveTo(65.726563, 34.548357, 56.446958, 43.827962, 45.000000, 43.827962);\n    context.fill();\n    context.restore();\n  }\n\n  renderImage(context, position, mapZoom) {\n    if (this.options.image) {\n      this.renderShadow(context, position, mapZoom);\n\n      const size = this.size;\n      const x = position[0] - size[0] / 2 + this.offset[0];\n      const y = position[1] - size[1] / 2 + this.offset[1];\n\n      context.drawImage(this.options.image, x, y, size[0], size[1]);\n    }\n  }\n\n  renderShadow(context, position, mapZoom) {\n    if (this.options.enableShadow && mapZoom > 8) {\n      context.save();\n      context.fillStyle = context.strokeStyle = context.shadowColor = 'rgb(227, 213, 217)';\n      context.shadowBlur = 5;\n\n      context.beginPath();\n      context.ellipse(position[0], position[1] + 2, 5, 2.5, Math.PI, 0, 2 * Math.PI);\n      context.fill();\n      context.restore();\n    }\n  }\n}\n","export default function(x) {\n  return x;\n}\n","import identity from \"./identity\";\n\nexport default function(transform) {\n  if (transform == null) return identity;\n  var x0,\n      y0,\n      kx = transform.scale[0],\n      ky = transform.scale[1],\n      dx = transform.translate[0],\n      dy = transform.translate[1];\n  return function(input, i) {\n    if (!i) x0 = y0 = 0;\n    var j = 2, n = input.length, output = new Array(n);\n    output[0] = (x0 += input[0]) * kx + dx;\n    output[1] = (y0 += input[1]) * ky + dy;\n    while (j < n) output[j] = input[j], ++j;\n    return output;\n  };\n}\n","export default function(array, n) {\n  var t, j = array.length, i = j - n;\n  while (i < --j) t = array[i], array[i++] = array[j], array[j] = t;\n}\n","import reverse from \"./reverse\";\nimport transform from \"./transform\";\n\nexport default function(topology, o) {\n  return o.type === \"GeometryCollection\"\n      ? {type: \"FeatureCollection\", features: o.geometries.map(function(o) { return feature(topology, o); })}\n      : feature(topology, o);\n}\n\nexport function feature(topology, o) {\n  var id = o.id,\n      bbox = o.bbox,\n      properties = o.properties == null ? {} : o.properties,\n      geometry = object(topology, o);\n  return id == null && bbox == null ? {type: \"Feature\", properties: properties, geometry: geometry}\n      : bbox == null ? {type: \"Feature\", id: id, properties: properties, geometry: geometry}\n      : {type: \"Feature\", id: id, bbox: bbox, properties: properties, geometry: geometry};\n}\n\nexport function object(topology, o) {\n  var transformPoint = transform(topology.transform),\n      arcs = topology.arcs;\n\n  function arc(i, points) {\n    if (points.length) points.pop();\n    for (var a = arcs[i < 0 ? ~i : i], k = 0, n = a.length; k < n; ++k) {\n      points.push(transformPoint(a[k], k));\n    }\n    if (i < 0) reverse(points, n);\n  }\n\n  function point(p) {\n    return transformPoint(p);\n  }\n\n  function line(arcs) {\n    var points = [];\n    for (var i = 0, n = arcs.length; i < n; ++i) arc(arcs[i], points);\n    if (points.length < 2) points.push(points[0]); // This should never happen per the specification.\n    return points;\n  }\n\n  function ring(arcs) {\n    var points = line(arcs);\n    while (points.length < 4) points.push(points[0]); // This may happen if an arc has only two points.\n    return points;\n  }\n\n  function polygon(arcs) {\n    return arcs.map(ring);\n  }\n\n  function geometry(o) {\n    var type = o.type, coordinates;\n    switch (type) {\n      case \"GeometryCollection\": return {type: type, geometries: o.geometries.map(geometry)};\n      case \"Point\": coordinates = point(o.coordinates); break;\n      case \"MultiPoint\": coordinates = o.coordinates.map(point); break;\n      case \"LineString\": coordinates = line(o.arcs); break;\n      case \"MultiLineString\": coordinates = o.arcs.map(line); break;\n      case \"Polygon\": coordinates = polygon(o.arcs); break;\n      case \"MultiPolygon\": coordinates = o.arcs.map(polygon); break;\n      default: return null;\n    }\n    return {type: type, coordinates: coordinates};\n  }\n\n  return geometry(o);\n}\n","export default function(a, x) {\n  var lo = 0, hi = a.length;\n  while (lo < hi) {\n    var mid = lo + hi >>> 1;\n    if (a[mid] < x) lo = mid + 1;\n    else hi = mid;\n  }\n  return lo;\n}\n","import { defaultPolygonOptions, defaultPolygonHoverOptions } from './defaultOptions';\nimport TileConversion from './TileConversion';\nimport { feature } from 'topojson-client';\nimport classifyPoint from 'robust-point-in-polygon';\n\nexport default class Polygon {\n  constructor(json, objectName, options = {}, hoverOptions = null, meta = {}) {\n    this._options = Object.assign({}, defaultPolygonOptions, options);\n    this._hoverOptions = Object.assign({}, defaultPolygonOptions, defaultPolygonHoverOptions, hoverOptions);\n    this._meta = meta;\n    this.globalIndex = this.prepareGlobalDataObject();\n\n    if (!objectName) {\n      objectName = Object.keys(json.objects)[0];\n    }\n\n    if (!(objectName in json.objects)) {\n      throw new Error(`Invalid object name, valid options are: ${Object.keys(json.objects).join(', ')}`);\n    }\n\n    this.geometry = feature(json, json.objects[objectName]);\n  }\n\n  get options() {\n    return this._options;\n  }\n\n  get hoverOptions() {\n    return this._hoverOptions;\n  }\n\n  get meta() {\n    return this._meta;\n  }\n\n  get geometry() {\n    return window.lightningMapsPolygons[this.globalIndex].geometry;\n  }\n\n  set geometry(geometry) {\n    window.lightningMapsPolygons[this.globalIndex].geometry = geometry;\n  }\n\n  get projectedGeometry() {\n    return window.lightningMapsPolygons[this.globalIndex].projectedGeometry;\n  }\n\n  set projectedGeometry(projectedGeometry) {\n    window.lightningMapsPolygons[this.globalIndex].projectedGeometry = projectedGeometry;\n  }\n\n  prepareGlobalDataObject() {\n    if (!('lightningMapsPolygons' in window)) {\n      window.lightningMapsPolygons = [];\n    }\n\n    const index = window.lightningMapsPolygons.length;\n\n    window.lightningMapsPolygons[index] = {\n      geometry: null,\n      projectedGeometry: null\n    };\n\n    return index;\n  }\n\n  handleMouseOver(context, mapState, mousePosition) {\n    const currentlyZooming = Math.round(mapState.zoom) !== mapState.zoom;\n\n    if (!this.options.interactive || !this.geometry || !this.projectedGeometry || currentlyZooming\n        || (mousePosition.x < 0 && mousePosition.y < 0)) {\n      return [];\n    }\n\n    const originZoom = this.determineOriginZoom(mapState);\n    const centerOffset = this.calculateCenterOffset(mapState, originZoom);\n    const point = [\n      mousePosition.x - centerOffset[0] - mapState.canvasCenter[0],\n      mousePosition.y - centerOffset[1] - mapState.canvasCenter[1]\n    ];\n\n    return this.projectedGeometry.filter(item => {\n      const isHover = item.geometry.filter(list => classifyPoint(list, point) === -1).length > 0;\n\n      if (isHover && context) {\n        context.beginPath();\n\n        item.geometry.map((list) => {\n          list.map((position, index) => {\n            position = [\n              position[0] + centerOffset[0] + mapState.canvasCenter[0],\n              position[1] + centerOffset[1] + mapState.canvasCenter[1]\n            ];\n\n            if (index === 0) {\n              context.moveTo(position[0], position[1]);\n            } else {\n              context.lineTo(position[0], position[1]);\n            }\n          });\n        });\n\n        this.applyContextStyles(context, this.hoverOptions, mapState.zoom);\n\n        if (this.options.enableStroke) context.fill();\n        if (this.options.enableFill) context.stroke();\n      }\n\n      return isHover;\n    });\n  }\n\n  calculateCenterOffset(mapState, originZoom) {\n    return [\n      -(TileConversion.lon2tile(mapState.center[1], originZoom, false) * mapState.tileSize),\n      -(TileConversion.lat2tile(mapState.center[0], originZoom, false) * mapState.tileSize)\n    ];\n  }\n\n  shouldReRender(mapState, zoomDiff) {\n    const mapCenterChanged = this.renderedMapCenter !== mapState.center,\n      mapZoomChanged = (zoomDiff === 0 && this.renderedZoomLevel !== mapState.zoom);\n\n    return mapCenterChanged || mapZoomChanged;\n  }\n\n  render(context, mapState) {\n    if (!this.geometry) {\n      return;\n    }\n\n    const originZoom = this.determineOriginZoom(mapState);\n\n    const zoomDiff = originZoom\n      ? mapState.zoom - originZoom\n      : 0;\n\n    const scale = zoomDiff !== 0\n      ? Math.pow(2, zoomDiff)\n      : 1;\n\n    if (this.shouldReRender(mapState, zoomDiff)) {\n      let centerOffset = null;\n\n      this.renderedZoomLevel = mapState.zoom;\n      this.renderedMapCenter = mapState.center;\n\n      this.projectedGeometry = this.geometry.features.map(feature => {\n        return {\n          ...feature,\n          geometry: this.projectGeometry(feature.geometry, mapState)\n        };\n      });\n\n      centerOffset = this.calculateCenterOffset(mapState, originZoom);\n\n      this.calculatePolygonExtends(centerOffset);\n\n      const imagePosition = [\n        mapState.canvasCenter[0] + mapState.moveOffset[0] + (this.polygonExtends.minX * scale),\n        mapState.canvasCenter[1] + mapState.moveOffset[1] + (this.polygonExtends.minY * scale)\n      ];\n\n      const imageRect = {\n        left: Math.floor(imagePosition[0] * -1),\n        right: Math.ceil(Math.abs(imagePosition[0]) + mapState.canvasDimensions[0]),\n        top: Math.floor(imagePosition[1] * -1),\n        bottom: Math.ceil(Math.abs(imagePosition[1]) + mapState.canvasDimensions[1])\n      };\n\n      this.renderOffscreenCanvas(mapState, centerOffset, imageRect);\n    }\n\n    const imageDrawPosition = [\n      mapState.moveOffset[0] - (mapState.canvasCenter[0] * (scale - 1)),\n      mapState.moveOffset[1] - (mapState.canvasCenter[1] * (scale - 1))\n    ];\n\n    const scaledWidth = this.polygonDimensions[0] * scale,\n      scaledHeight = this.polygonDimensions[1] * scale;\n\n    context.drawImage(\n      this.offscreenCanvas,\n      imageDrawPosition[0], imageDrawPosition[1],\n      scaledWidth, scaledHeight\n    );\n  }\n\n  determineOriginZoom(mapState) {\n    let originZoom = mapState.zoom;\n\n    if (mapState.targetZoom > mapState.zoom) { // Zoming in\n      originZoom = Math.floor(mapState.zoom);\n    } else if (mapState.targetZoom < mapState.zoom) { // Zooming out\n      originZoom = Math.ceil(mapState.zoom);\n    }\n\n    return originZoom;\n  }\n\n  createOffscreenCanvas(clipRect) {\n    this.polygonDimensions = [\n      clipRect.right - clipRect.left,\n      clipRect.bottom - clipRect.top\n    ];\n\n    this.offscreenCanvas = document.createElement('canvas');\n    this.offscreenCanvas.width = this.polygonDimensions[0];\n    this.offscreenCanvas.height = this.polygonDimensions[1];\n\n    return this.offscreenCanvas.getContext('2d');\n  }\n\n  calculatePolygonExtends(centerOffset) {\n    let minX, maxX, minY, maxY = null;\n\n    this.mapGeometry(position => {\n      position = [\n        position[0] + centerOffset[0],\n        position[1] + centerOffset[1]\n      ];\n\n      if (!maxX || position[0] > maxX) {\n        maxX = position[0];\n      }\n\n      if (!minX || position[0] < minX) {\n        minX = position[0];\n      }\n\n      if (!maxY || position[1] > maxY) {\n        maxY = position[1];\n      }\n\n      if (!minY || position[1] < minY) {\n        minY = position[1];\n      }\n    });\n\n    this.polygonDimensions = [\n      Math.ceil(maxX - minX),\n      Math.ceil(maxY - minY)\n    ];\n\n    this.polygonExtends = {\n      minX, maxX,\n      minY, maxY\n    };\n  }\n\n  renderOffscreenCanvas(mapState, centerOffset, clipRect) {\n    const offscreenContext = this.createOffscreenCanvas(clipRect);\n\n    offscreenContext.beginPath();\n    offscreenContext.font = 'bold 8px helvetica';\n\n    this.projectedGeometry.map((item) =>\n      item.geometry.map((list) => {\n        const pointsInClipRect = list.filter(position => {\n          position = [\n            position[0] - this.polygonExtends.minX + centerOffset[0],\n            position[1] - this.polygonExtends.minY + centerOffset[1]\n          ];\n\n          return position[0] >= clipRect.left && position[0] <= clipRect.right\n           && position[1] >= clipRect.top && position[1] <= clipRect.bottom;\n        });\n\n        if (pointsInClipRect.length > 0) {\n          list.map((position, index) => {\n            position = [\n              position[0] - this.polygonExtends.minX + centerOffset[0] - clipRect.left,\n              position[1] - this.polygonExtends.minY + centerOffset[1] - clipRect.top\n            ];\n\n            if (index === 0) {\n              // offscreenContext.fillText(item.properties.NAME, position[0], position[1]);\n\n              offscreenContext.moveTo(position[0], position[1]);\n            } else {\n              offscreenContext.lineTo(position[0], position[1]);\n            }\n          });\n        }\n      })\n    );\n\n    this.applyContextStyles(offscreenContext, this.options, mapState.zoom);\n\n    if (this.options.enableStroke) offscreenContext.fill();\n    if (this.options.enableFill) offscreenContext.stroke();\n  }\n\n  applyContextStyles(context, options, zoom) {\n    context.fillStyle = options.fillStyle;\n    context.strokeStyle = options.strokeStyle;\n    context.lineWidth = options.lineWidth * zoom;\n    context.setLineDash(options.lineDash);\n    context.lineJoin = 'round';\n  }\n\n  mapGeometry(pointCallback) {\n    return this.projectedGeometry.map((item) =>\n      item.geometry.map((list) =>\n        list.map(pointCallback)\n      )\n    );\n  }\n\n  projectGeometry(geometry, mapState) {\n    if (geometry) {\n      switch (geometry.type) {\n        case 'Polygon':\n          return [geometry.coordinates[0].map(item => this.projectPoint(mapState, item[0], item[1]))];\n\n        case 'MultiPolygon':\n          return geometry.coordinates.map(coordinates =>\n            coordinates[0].map(item => this.projectPoint(mapState, item[0], item[1]))\n          );\n      }\n    }\n\n    return [];\n  }\n\n  projectPoint(mapState, x, y) {\n    const position = TileConversion.latLonToPixel(\n      [y, x],\n      null,\n      mapState.zoom,\n      mapState.tileSize\n    );\n\n    return [-position[0], -position[1]];\n  }\n}\n","import Map from './Map';\nimport Marker from './Marker';\nimport Polygon from './Polygon';\n\nexport {\n  Map,\n  Marker,\n  Polygon\n};\n"],"sourceRoot":""}